<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'
      lang="en"
      resource="http://www.w3.org/ns/csvw#"
      typeof="owl:Ontology"
      prefix "csvw: http://www.w3.org/ns/csvw#">
  <head>
    <meta charset='utf-8'/>
    <title><%= ont["dc:title"]["en"] %></title>
    <link type="text/css" rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/base.css">
    <style type="text/css">
  	  code {font-weight: bold}
      dt {
        float: left;
        clear: left;
        width: 15vw;
      }
      dd:after {
          content: '';
          display: block;
          clear: both;
          margin-bottom: 5px;
      }
      table.rdfs-definition td {vertical-align: top;}
      .bold {font-weight: bold;}
    </style>
  </head>
  <body resource="http://www.w3.org/ns/csvw#" typeof="owl:Ontology">
    <section class='head'>
      <p><a href="http://www.w3.org/"><img width="72" height="48" alt="W3C" src="http://www.w3.org/Icons/w3c_home"/></a></p>
      <h1><%= ont["dc:title"]["en"] %></h1>
      <p>
        This document describes the
        <span property="dc:title"><%= ont["dc:title"]["en"] %></span>
        and Term definitions used
        for creating Metadata descriptions for Tabular Data.
      </p>
    </section>
    <section>
      <h2>Introduction</h2>
      <p property="dc:description"><%= ont["dc:description"]["en"] %></p>
      <p>This specification makes use of the following namespaces:</p>
      <dl>
        <dt><code>csvw</code>:</dt>
        <dd><code>http://www.w3.org/ns/csvw#</code></dd>
        <dt><code>rdf</code>:</dt>
        <dd><code>http://www.w3.org/1999/02/22-rdf-syntax-ns#</code></dd>
        <dt><code>rdfs</code>:</dt>
        <dd><code>http://www.w3.org/2000/01/rdf-schema#</code></dd>
        <dt><code>xsd</code>:</dt>
        <dd><code>http://www.w3.org/2001/XMLSchema#</code></dd>
        <dt><code>dc</code>:</dt>
        <dd><code>http://purl.org/dc/terms/</code></dd>
        <dt><code>dcat</code>:</dt>
        <dd><code>http://www.w3.org/ns/dcat#</code></dd>
        <dt><code>prov</code>:</dt>
        <dd><code>http://www.w3.org/ns/prov#</code></dd>
      </dl>
    </section>
    <%
      [{
        heading: "Class Definitions",
        key: "rdfs_classes"
      }, {
        heading: "Property Definitions",
        key: "rdfs_properties"
      }, {
        heading: "Datatype Definitions",
        key: "rdfs_datatypes"
      }, {
        heading: "Instance Definitions",
        key: "rdfs_instances"
      }].each do |sect|
    %>
    <section>
      <h2><%= sect[:heading] %></h2>
      <p>The following are <%= sect[:heading].downcase %> in the <code>csvw</code> namespace:</p>
      <table class="rdfs-definition">
        <% ont[sect[:key]].each do |defn| -%>
        <tr><td class="bold"><%= defn['@id'][5..-1] %></td>
          <td resource="<%= defn['@id'] %>" typeof="<%= Array(defn['@type']).join(" ") %>">
            <em property="rdfs:label"><%= defn['rdfs:label']['en'] %></em>
            <p property="rdfs:comment"><%= defn['rdfs:comment']['en'] %></p>
            <span property="rdfs:isDefinedBy" resource="csvw:"></span>
            <% if %w(rdfs:subClassOf rdfs:subPropertyOf rdfs:range rdfs:domain).any? { |p| defn.has_key?(p)} %>
              <dl>
                <% %w(rdfs:subClassOf rdfs:subPropertyOf rdfs:range rdfs:domain).each do |p| %>
                  <% if defn.has_key?(p) %>
                  <dt><%= p %></dt>
                  <% Array(defn[p]).each do |v| %>
                    <%if v.is_a?(Array) && v.first == 'owl:unionOf' %>
                      <dd property="<%= p %>" resource="_:">
                        Union of
                        <% v.last.each do |c| %>
                        <span property="owl:unionOf" inlist=true resource="<%= c %>"><%= c %></span>
                        <% end%>
                      </dd>
                    <% else %>
                      <dd property="<%= p %>" resource="<%= v %>"><%= v %></dd>
                    <% end %>
                  <% end %>
                  <% end %>
                <% end %>
              </dl>
            <% end %>
          </td>
        </tr>
        <% end -%>
      </table>
    </section>
    <% end%>
    <section>
      <h2>Term Definitions</h2>
      <dl>
        <% ont['@context'].keys.sort.each do |term|%>
        <% defn = ont['@context'][term] %>
        <dt><%= term %></dt>
        <dd>
          <% if defn.is_a?(String) %>
            <%= defn %>
          <% elsif defn['@id'] %>
            <%= defn['@id'] %>
          <% elsif defn['@reverse'] %>
            reverse of <%= defn['@reverse'] %>
          <% else %>
            <%= term %>
          <% end %>
          <% if defn.is_a?(Hash) && defn['@type'] %>
            with string values interpreted as <%= defn['@type'] %>
          <% end%>
          <% if defn.is_a?(Hash) && defn['@container'] %>
            with array values interpreted as <%= defn['@container'] %>
          <% end%>
        </dd>
        <% end %>
      </dl>
    </section>
  </body>
</html>
