<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width,initial-scale=1" name="viewport" />
    <title>Metadata Vocabulary for Tabular Data</title>
    <script class="remove" src="https://www.w3.org/Tools/respec/respec-w3c-common">
		</script>
    <script class="remove">
var respecConfig = {
    localBiblio: {
      "tabular-data-model": {
          "authors": [
            "Jeni Tennison",
            "Gregg Kellogg"
          ],
          "title": "Model for Tabular Data and Metadata on the Web",
          "href" : "http://www.w3.org/TR/2014/WD-tabular-data-model-20150108/",
          "rawDate": "2015-01-08",
          "status" : "WD",
          "publisher": "W3C"
      },
      "csvw-context": {
          "authors": [
            "Gregg Kellogg"
          ],
          "title": "Metadata Vocabulary for Tabular Data",
          "href" : "http://www.w3.org/ns/csvw",
          "publisher": "W3C"
      },
      "UNICODE-BIDI" : {
        "authors" : [
          "Mark Davis",
          "Aharon Lanin",
          "Andrew Glass"
        ],
        "title": "TR9, Unicode Bidirectional Algorithm",
        "href": "http://unicode.org/reports/tr9/",
        "rawDate" : "2013-09-24",
        "publisher" : "Unicode Consortium",
        "status" : "Report"
      }
    },
    specStatus: "ED",
    shortName: "tabular-metadata",
    //publishDate:  "2014-03-27",
    previousPublishDate: "2015-01-08",
    previousMaturity: "WD",
    previousURI: "http://www.w3.org/TR/2014/WD-tabular-metadata-20150108/",
    edDraftURI: "http://w3c.github.io/csvw/metadata/",
    // lcEnd: "3000-01-01",
    // crEnd: "3000-01-01",
    editors: [{ 
      name: "Rufus Pollock", 
      url: "http://rufuspollock.org/",
      company: "Open Knowledge", 
      companyURL: "https://okfn.org/" 
    }, {
      name: "Jeni Tennison",
      company: "Open Data Institute",
      companyURL: "http://theodi.org/"
    }, { 
      name: "Gregg Kellogg", 
      url: "http://greggkellogg.net/",
      company: "Kellogg Associates", 
      companyURL: "http://kellogg-assoc.com/" 
    }],
    wg: "CSV on the Web Working Group",
    wgURI: "http://www.w3.org/2013/csvw/",
    wgPublicList: "public-csv-wg",
    wgPatentURI: "http://www.w3.org/2004/01/pp-impl/68238/status",
    otherLinks: [{
      key: "Repository",
      data: [{
          value: "We are on Github",
          href: "https://github.com/w3c/csvw"
      }, {
          value: "File a bug",
          href: "https://github.com/w3c/csvw"
      }]
      }, {
      key: "Changes",
        data: [{
          value: "Diff to previous version",
          href: "diff-20150108.html"
        }, {
          value: "Commit history",
          href: "https://github.com/w3c/csvw/commits/gh-pages"
      }]
    }],
    inlineCSS: true,
    issueBase: "https://github.com/w3c/csvw/issues/",
    noIDLIn: true,
    noLegacyStyle: false
    };
    </script>
    <script class="remove">
    function escapeContent(doc, content) {
          var utils = require("core/utils");
    // perform transformations to make it render and prettier
      return utils.xmlEscape(content);
    }
    </script>
    <style>
      td, th { padding-left: 1em; padding-right: 1em; }
      tbody tr th { text-align: left; }
    </style>
  </head>
  <body>
    <section id="abstract">
      <p>
        Validation, conversion, display and search of tabular data on the web requires additional metadata that describes how the data should be interpreted. This document defines a vocabulary for metadata that annotates tabular data. This can be used to provide metadata at various levels, from collections of data from CSV documents and how they relate to each other down to individual cells within a table.
      </p>
    </section>
    <section id="sotd">
      <p>
        The CSV on the Web Working Group was chartered to produce a Recommendation "Access methods for CSV Metadata" as well as Recommendations for "Metadata vocabulary for CSV data" and "Mapping mechanism to transforming CSV into various Formats (e.g., RDF, JSON, or XML)". This document aims to primarily satisfy the second of those Recommendations.
      </p>
    </section>
    <section>
      <h2>Introduction</h2>
      <p>
        Interpreting tabular data that is available on the web, particularly as CSV, usually requires additional metadata. As an example, say that the following CSV file were available at <code>http://example.org/tree-ops.csv</code>
      </p>
      <pre class="example">
GID,On Street,Species,Trim Cycle,Inventory Date
1,ADDISON AV,Celtis australis,Large Tree Routine Prune,10/18/2010
2,EMERSON ST,Liquidambar styraciflua,Large Tree Routine Prune,6/2/2010
3,EMERSON ST,Liquidambar styraciflua,Large Tree Routine Prune,6/2/2010
      </pre>
      <p>
        A human consumer of this data might be able to figure out the meaning of the different columns, particularly if there were some additional human-readable documentation made available. Automated processors would have a much harder time; realistically they would be limited to displaying the information in a table. Making available machine-readable metadata helps with the interpretation of the tabular data. For example, say that the following metadata file were available at <code>http://example.org/trees-ops.csv-metadata.json</code>:
      </p>
      <pre class="example highlight">
{
  "@context": ["http://www.w3.org/ns/csvw", {"@language": "en"}],
  "url": "tree-ops.csv",
  "dc:title": "Tree Operations",
  "dc:keywords": ["tree", "street", "maintenance"],
  "dc:publisher": [{
    "schema:name": "Example Municipality",
    "schema:url": "http://example.org"
  }],
  "dc:license": "http://opendefinition.org/licenses/cc-by/",
  "dc:modified": "2010-12-31",
  "tableSchema": {
    "columns": [{
      "name": "GID",
      "title": [
        "GID",
        "Generic Identifier"
      ],
      "dc:description": "An identifier for the operation on a tree.",
      "datatype": "string",
      "required": true
    }, {
      "name": "on_street",
      "title": "On Street",
      "dc:description": "The street that the tree is on.",
      "datatype": "string"
    }, {
      "name": "species",
      "title": "Species",
      "dc:description": "The species of the tree.",
      "datatype": "string"
    }, {
      "name": "trim_cycle",
      "title": "Trim Cycle",
      "dc:description": "The operation performed on the tree.",
      "datatype": "string"
    }, {
      "name": "inventory_date",
      "title": "Inventory Date",
      "dc:description": "The date of the operation that was performed.",
      "datatype": "date",
      "format": "M/D/YYYY"
    }],
    "primaryKey": "GID"
  }
}
      </pre>
      <p>
        Given the location of the CSV file, this metadata document can be located by appending <code>-metadata.json</code> to the URL (as described in <a href="http://www.w3.org/TR/tabular-data-model/#standard-file-metadata">Model for Tabular Data and Metadata on the Web</a>). It provides information for different types of applications:
      </p>
      <ul>
        <li><dfn>Viewers</dfn> can use the indicated metadata to provide a more user-friendly or human-readable view of the CSV file, which might include displaying it in a table or as graphs or charts.</li>
        <li><dfn>Data entry tools</dfn> can use the metadata to prompt people to supply information that is added to a CSV file</li>
        <li><dfn>Validators</dfn> can check that the labels of the columns in the metadata file match those in the CSV file, that the values in the columns are of the right type and in the right format, and that values in the <code>GID</code> column are all present and unique.</li>
        <li><dfn>Converters</dfn> can use the metadata to map the CSV data into other formats such as JSON, RDF and XML, or into databases or statistical applications, in intelligent ways.</li>
        <li><dfn>Data Aggregators</dfn> can use the indicated metadata, such as descriptions, titles, modification dates and licences, to enable more intelligent retrieval of relevant data on the web.</li>
      </ul>
      <p class="note">
        Implementations may fulfil one or more of these functions. In particular, <a>Converters</a> may or may not act as a <a title="Validators">Validator</a> (perhaps through the setting of a flag), and check the data that they are converting to ensure that it is complant with the schema. If a Converter does not also act as a Validator it may produce invalid output.
      </p>
      <p>
        The <a href="http://www.w3.org/TR/tabular-data-model/">Model for Tabular Data and Metadata on the Web</a> specification defines an <a href="http://www.w3.org/TR/tabular-data-model/#annotated-tabular-data-model">Annotated Tabular Data Model</a> in which tables, columns, rows and cells can be annotated with properties and values, and a <a href="http://www.w3.org/TR/tabular-data-model/#grouped-tabular-data-model">Grouped Tabular Data Model</a> in which a group of tables is annotated. That specification also describes <a href="http://www.w3.org/TR/tabular-data-model/#locating-metadata">how to locate metadata</a> about a given CSV file.
      </p>
      <p>
        This document defines the format and structure of metadata documents, and how these are interpreted to create an Annotated Tabular Data Model. It also defines how to validate tabular data based on some of these annotations. This metadata can be expressed as an RDF graph. However, all applications that conform to this specification (including validators and applications that read or convert tabular data) MUST read the JSON-based format described in this document.
      </p>
    </section>
    <section>
      <h2>Annotating Tables</h2>
      <p>
        The metadata defined in this specification is used to annotate an existing <a href="http://www.w3.org/TR/tabular-data-model/#dfn-annotated-table">annotated table</a> or <a href="http://www.w3.org/TR/tabular-data-model/#dfn-group-of-tables">group of tables</a>, as defined in [[!tabular-data-model]]. Annotated tables form the basis for all further processing, such as validating or displaying the tables. All compliant applications MUST create annotated tables based on the algorithm defined here.
      </p>
      <p>
        Metadata documents contain descriptions of groups of tables, tables, columns, rows, cells and regions which are used to create annotations on a tabular data model. There are two types of description objects:
      </p>
      <ul>
        <li>descriptions that appear within a schema, and that may apply across multiple tabular data files &mdash; these are used to describe the general structure of a tabular data file</li>
        <li>descriptions of particular groups of tables, tables, columns, rows, cells and regions within a single tabular data file &mdash; these are used for notes or flags on particular data</li>
      </ul>
      <p>
        The description objects themselves contain a number of properties. These are:
      </p>
      <ul>
        <li>properties that are used to identify the table or column that the annotations should appear on; these match up to core properties on those objects in the annotated tabular data model defined in [[!tabular-data-model]] and do not form additional annotations</li>
        <li>properties that map directly to annotations that appear directly on the group of tables, table, column, row or cell whose description they appear on, such as the <code>name</code> of a column or the <code>dc:provenance</code> of a table</li>
        <li>properties that are specified on the description of a group of tables, table or column to provide a default value for the equivalent annotation on each of the cells that appear in that table or column</li>
      </ul>
      <p>
        For example, in the <a>column description</a>
      </p>
      <pre class="example highlight">
{
  "name": "inventory_date",
  "title": "Inventory Date",
  "dc:description": "The date of the operation that was performed.",
  "datatype": "date",
  "format": "M/D/YYYY"
}
      </pre>
      <p>
        the properties <code>name</code>, <code>title</code> and <code>dc:description</code> are <a title="direct annotation">direct annotations</a> that become <code>name</code>, <code>title</code> and <code>dc:description</code> properties on the column in the data model. The <code>datatype</code> and <code>format</code> properties are <a title="inherited property">inherited properties</a> that become <code>datatype</code> and <code>format</code> properties on the cells within the column.
      </p>
      <p>The <dfn>property value</dfn> of an annotation is that defined in the metadata, unless otherwise noted.</p>
      <section>
        <h3>Direct Annotations</h3>
        <p>
          <dfn title="direct annotation">Direct annotations</dfn> are properties on the description object for a given table, column, row or cell which map directly to properties on the described table, column, row or cell. The name of the annotation is the same as the name of the property on the annotation. The value of the annotation is the same as the value of the property on the description object.
        </p>
      </section>
      <section>
        <h3>Inherited Properties</h3>
        <p>
          A cell may be assigned annotations based on properties on the description objects for the group of tables, table, column or row that it appears in. These properties are known as <dfn title="inherited property">inherited properties</dfn> and are listed in <a href="#inherited-properties-1" class="sectionRef"></a>. To ascertain a value for these annotations, an application MUST identify the relevant property in the descriptions of the table or column.
        </p>
        <p>
          Applications MUST raise an error if the value of a property in a table description is not <a>compatible with</a> the value of that property on the group of tables. Applications MUST raise an error if the value of a property in a column description is not <a>compatible with</a> the value of that property on the table. Applications MUST raise an error if the value of a property on a cell is not <a>compatible with</a> the values of that property on the column that the cell is associated with.
        </p>
        <p>
          A value for a cell, column or table is <dfn>compatible with</dfn> with a value on a column, table or group of tables if they are the same value or if the first value is a sub-value of the second value. The definitions of individual <a title="inherited property">inherited properties</a> indicate what values count as sub-values of others.
        </p>
      </section>
    </section>
    <section>
      <h2>Metadata Format</h2>
      <p>
        This section defines a set of properties and permitted values for annotating tabular data, and how these annotations should be interpreted by applications.
      </p>
      <p>
        A metadata document is a JSON document which holds an object at the top level. This object is a <a>description object</a> of either a table group or a single table. A <dfn>description object</dfn> is a JSON object that describes a component of the tabular data model (a table group, a table, a column, a row or a cell) and has one or more properties are mapped into properties on that component. 
      </p>
      <section>
        <h3>Property Syntax</h3>
        <p>
          There are different types of properties on description objects:
        </p>
        <dl>
          <dt><dfn title="array property">array properties</dfn></dt>
          <dd>
            <p>These hold an array of one or more objects, which are usually <a title="description object">description objects</a>.</p>
            <p>
              For example, the <code>resources</code> property is an array property. A <a>table group description</a> might contain:
            </p>
            <pre>
"resources": [{
  "url": "https://example.org/countries.csv",
  "tableSchema": "https://example.org/countries.json"
}, {
  "url": "https://example.org/country_slice.csv",
  "tableSchema": "https://example.org/country_slice.json"
}]
            </pre>
            <p>
              in which case the <code>resources</code> property has a value that is an array of two <a>table description</a> objects.
            </p>
          </dd>
          <dt><dfn title="link property">link properties</dfn></dt>
          <dd>
            <p>These hold a single reference to anther resource by URL. Their value is a
              <strong>strings</strong> &mdash; resolved as URLs against the <a>base URL</a>.
            </p>
            <p>
              For example, the <code>url</code> property is a link property. A <a>table description</a> might contain:
            </p>
            <pre class="example highlight">
"url": "example-2014-01-03.csv"
            </pre>
            <p>
              in which case the <code>url</code> property on the table would have a single value, a link to <code>example-2014-01-03.csv</code>.
            </p>
          </dd>
          <dt><dfn title="URI template property">URI template properties</dfn></dt>
          <dd>
            <p>
              A URI template property contains a [[!URI-TEMPLATE]] which can be used to generate a URI. These URI templates are expanded in the context of each row by combining the template with a set of variables with values. The variables that are set are:
            </p>
            <dl>
              <dt><code>_column</code></dt>
              <dd><code>_column</code> is set to the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-column-number" class="externalDFN">column number</a> of the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-column" class="externalDFN">column</a> from the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-annotated-table" class="externalDFN">annotated table</a>that is currently being processed</dd>
              <dt><code>_sourceColumn</code></dt>
              <dd><code>_sourceColumn</code> is set to the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-column-source-number">source number</a> of the column that is currently being processed; this varies form <a>_column</a> by <a href="http://www.w3.org/TR/tabular-data-model/#dfn-skip-columns">skip columns</a> and <a href="http://www.w3.org/TR/tabular-data-model/#dfn-header-columns">header columns</a></dd>
              <dt><code>_row</code></dt>
              <dd><code>_row</code> is set to the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-row-number" class="externalDFN">row number</a> of the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-row" class="externalDFN">row</a> from the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-annotated-table" class="externalDFN">annotated table</a>that is currently being processed</dd>
              <dt><code>_sourceRow</code></dt>
              <dd><code>_sourceRow</code> is set to the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-row-source-number">source number</a> of the row that is currently being processed; this varies form <a>_row</a> by <a href="http://www.w3.org/TR/tabular-data-model/#dfn-skip-rows">skip rows</a> and <a href="http://www.w3.org/TR/tabular-data-model/#dfn-header-rows">header rows</a></dd>
              <dt><code>_name</code></dt>
              <dd><code>_name</code> is set to the URI decoded <a>property value</a> of the <code>name</code> property on the cell column that is currently being processed. <span class="note">URI decoding is necessary as <code>name</code> may have been encoded if taken from <code>title</code>; this prevents double URI encoding.</span>
              </dd>
              <dt>column names</dt>
              <dd>a variable is set for each column within the schema; the name of the variable is the name of the column and the value is the canonical representation of the value of the cell in that column in the row that is currently being processed</dd>
            </dl>
            <p>The <a>property value</a> of a <a>URI template property</a> is only available while converting tables as defined in <a href="#converting-tables" class="sectionRef"></a>. The value is the result of applying the template against the cell in that column in the row that is currently being processed, resolving against the <a>base URL</a> as a <a>link property</a> if the metadata value is explicit in the metadata, or the default value if defined; otherwise there is no value.</p>
            <p>
              For example, the <a href="#cell-aboutUrl"><code>aboutUrl</code></a> property holds a URI template that is used to generate a URL identifier for each row, which might look like:
            </p>
            <pre class="example highlight">
"aboutUrl": "http://example.org/example.csv#row.{_row}"
            </pre>
            <p>
              The identifiers that are generated for the rows would then look like <code>http://example.org/example.csv#row.1</code>, <code>http://example.org/example.csv#row.2</code> and so on.
            </p>
            <p>
              Alternatively, with the CSV and metadata in the <a href="#introduction" class="sectionRef"></a>, the <a href="#cell-aboutUrl"><code>aboutUrl</code></a> might look like:
            </p>
            <pre class="example highlight">
"aboutUrl": "http://example.org/tree/{on%2Dstreet}/{GID}"
            </pre>
            <p>
              This would generate URIs such as <code>http://example.org/tree/ADDISON%20AV/1</code> and <code>http://example.org/tree/EMERSON%20ST/2</code>.
            </p>
            <p>
              Once the URI has been generated, it is resolved against the location of the resource (eg the CSV file) to create an absolute URI. For example, given a <a href="#cell-aboutUrl"><code>aboutUrl</code></a> within a schema such as:
            </p>
            <pre>
"aboutUrl": "#row.{_row}"
            </pre>
            <p>
              and given a CSV file at <code>http://example.com/temp.csv</code>, the URL for the first row will be <code>http://example.com/temp.csv#row.1</code>.
            </p>
            <p>The <code>propertyUrl</code> property has the default value of <code>"{#_name}</code>", meaning that it resolves as a fragment identifier relative to the <a>base URL</a>. For example, if no <code>propertyUrl</code> is specified, accessing it from a column with the column name <em>GID</em> would look like:</p>
            <pre class="example highlight" title="expanded default for propertyUrl">
"http://example.org/example.csv#GID"
            </pre>
          </dd>
          <dt><dfn title="column reference property">column reference properties</dfn></dt>
          <dd>
            <p>These hold one or more references to other column description objects. The referenced description object must have an <code>name</code> property. Column reference properties can then reference column description objects through values that are:</p>
            <ul>
              <li><strong>strings</strong> &mdash; which MUST match the <code>name</code> on a column description object within the metadata document</li>
              <li><strong>arrays</strong> &mdash; lists of strings as above</li>
            </ul>
            <p>
              For example, the <code>primaryKey</code> property is an column reference property on the schema. It has to hold references to columns defined elsewhere in the schema, and the descriptions of those columns must have <code>name</code> properties. It can hold a single reference, like this:
            </p>
            <pre class="example highlight">
"tableSchema": {
  "columns": [{
    "name": "GID"
  }, ... ],
  "primaryKey": "GID"
}
            </pre>
            <p>
              or it can contain an array of references, like this:
            </p>
            <pre class="example highlight">
"tableSchema": {
  "columns": [{
    "name": "givenName"
  }, {
    "name": "familyName"
  }, ... ],
  "primaryKey": [ "givenName", "familyName" ]
}
            </pre>
          </dd>
          <dt><dfn title="object property">object properties</dfn></dt>
          <dd>
            <p>These hold one or more objects or references to objects by URL. Their values may be:</p>
            <ul>
              <li><strong>strings</strong> &mdash; resolved as URLs against the <a>base URL</a></li>
              <li><strong>objects</strong> &mdash; interpreted as structured objects</li>
              <li><strong>arrays</strong> &mdash; lists of strings and/or objects, interpreted as URLs or structured objects</li>
            </ul>
            <p>
              Object properties are often used when the values can be or should be values within controlled vocabularies, or structured information which may be held elsewhere. For example, the <code>dc:creator</code> of a table should be an object property. It could be provided as a URL that indicates the creator, like this:
            </p>
            <pre class="example highlight">
"dc:creator": "http://ons.gov.uk"
            </pre>
            <p>
              or a structured object, like this:
            </p>
            <pre class="example highlight">
"dc:creator": {
  "schema:name": "Office of National Statistics",
  "schema:url": "http://ons.gov.uk",
  "schema:email": "info@ons.gsi.gov.uk"
}
            </pre>
            <p>
              or an array of URLs, like this:
            </p>
            <pre class="example highlight">
"dc:creator": [ "http://ons.gov.uk", "https://www.gov.uk/government/organisations/department-for-transport" ]
            </pre>
            <p>
              or an array of structured objects:
            </p>
            <pre class="example highlight">
"dc:creator": [{
  "schema:name": "Office of National Statistics",
  "schema:url": "http://ons.gov.uk",
  "schema:email": "info@ons.gsi.gov.uk"
}, {
  "schema:name": "Department for Transport",
  "schema:url": "https://www.gov.uk/government/organisations/department-for-transport"
}]
            </pre>
            <p>
              or an array that mixes URLs and objects:
            </p>
            <pre class="example highlight">
"dc:creator": [{
  "schema:name": "Office of National Statistics",
  "schema:url": "http://ons.gov.uk",
  "schema:email": "info@ons.gsi.gov.uk"
}, "https://www.gov.uk/government/organisations/department-for-transport" ]
            </pre>
          </dd>
          <dt><dfn title="natural language property">natural language properties</dfn></dt>
          <dd>
            <p>These hold natural language strings. Their values may be:</p>
            <ul>
              <li><strong>strings</strong> &mdash; interpreted as natural language strings in the <a>default language</a></li>
              <li><strong>arrays</strong> &mdash; interpreted as alternative natural language strings in the <a>default language</a></li>
              <li><strong>objects</strong> whose properties MUST be language codes as defined by [[!BCP47]] and whose values are either strings or arrays, providing natural language strings in that language</li>
            </ul>
            <p>
              Natural language properties are used for things like descriptions and titles. For example, the <code>title</code> property provides a natural language label for a column. If it's a plain string like this:
            </p>
            <pre class="example highlight">
"title": "Project title"
            </pre>
            <p>
              then that string is assumed to be in the language provided through the <code>@language</code> property of the <code>@context</code> (or have no assumed language, if there is no such property). Multiple alternative values can be given in an array:
            </p>
            <pre class="example highlight">
"title": [
  "Project title",
  "Project"
]
            </pre>
            <p>
              It's also possible to provide multiple values in different languages, using an object structure. For example:
            </p>
            <pre class="example highlight">
"title": {
  "en": "Project title",
  "fr": "Titre du projet"
}
            </pre>
            <p>
              and within such an object, the values of the properties can themselves be arrays:
            </p>
            <pre class="example highlight">
"title": {
  "en": [ "Project title", "Project" ],
  "fr": "Titre du projet"
}
            </pre>
            <p>
             The <a>property value</a> of a <a>natural language property</a> is an object whose properties are language codes and where the values of those properties are an array of strings (see <cite><a href="http://www.w3.org/TR/json-ld/#language-maps">Language Maps</a></cite> in [[!JSON-LD]]).</p>
             <p class="note">
               When extracting a <a>property value</a> metadata will have already been <a>merged</a>, a <a>natural language property</a> will already have this form.
             </p>
          </dd>
          <dt><dfn title="atomic property">atomic properties</dfn></dt>
          <dd>
            <p>These hold <dfn title="atomic value">atomic values</dfn>. Their values may be:</p>
            <ul>
              <li><strong>numbers</strong> &mdash; interpreted as integers or doubles</li>
              <li><strong>booleans</strong> &mdash; interpreted as booleans (<code>true</code> or <code>false</code>)</li>
              <li><strong>strings</strong> &mdash; interpreted as defined by the property</li>
              <li><strong>arrays</strong> &mdash; lists of numbers, booleans or strings</li>
            </ul>
            <p class="note">
              JSON does not have date or time types. Where a property takes a date as a value, this MUST be a string in the format <code>YYYY-MM-DD</code>.
            </p>
            <p class="issue" data-number="136">
              Having <strong>arrays</strong> as an atomic property creates issues when merging. We may consider the difference between an <a>atomic property</a> and an <a>atomic value</a>, where an atomic property takes an <a>atomic value</a> or an array of <a title="atomic value">atomic values</a>. However, the only case of an <a>atomic property</a> which accepts an array of values is <code>null</code>, which may not be required, so we may just restrict <code>null</code> to taking a single <a>atomic value</a>, and re-define an <a>atomic value</a> to be <strong>numbers</strong>, <strong>booleans</strong> or <strong>strings</strong>.
            </p>
          </dd>
        </dl>
      </section>
      <section>
        <h3>Top-Level Properties</h3>
        <p>
          The top-level object (whether it is a <a>table group description</a> or a <a>table description</a>) MUST have a <code>@context</code> property, an <a>array property</a>, as defined in <cite><a href="http://www.w3.org/TR/json-ld/#context-definitions">Section 8.7</a></cite> of [[!JSON-LD]]. The <code>@context</code> MUST contain one of the following:</p>
        <ul>
          <li>A string value of <code>http://www.w3.org/ns/csvw</code>, or</li>
          <li>An array composed of a string and an object, where the string is <code>http://www.w3.org/ns/csvw</code> and the object representing a local context definition, which is restricted to contain either or both of the following members.</li>
        </ul>
        <dl>
          <dt><code>@language</code></dt>
          <dd>
            <p>
              indicates the default language for the values of properties in the metadata document; if present, its value MUST be a language code [[!BCP47]] which is the <dfn>default language</dfn> for the values of other properties in the metadata document
            </p>
            <p class="note">
              Note that the <code>@language</code> property of the <code>@context</code> object, which gives the default language used within the metadata file, is distinct from the <code>lang</code> property on a <a>description object</a>, which gives the language used in the data within a group of tables, table or column.
            </p>
          </dd>
          <dt><code>@base</code></dt>
          <dd>
            <p>
              indicates the base URL against which other URLs within the description are resolved; if present, its value MUST be a URL which is resolved against the location of the metadata document to provide the <dfn>base URL</dfn> for other URLs in the metadata document; if unspecified, the base URL used for interpreting relative URLs within the metadata document is the location of the metadata document itself
            </p>
            <p class="note">
              Note that the <code>@base</code> property of the <code>@context</code> object provides the base URL used for URLs within the metadata document, not the URLs that appear within the group of tables or table it describes.
            </p>
          </dd>
        </dl>
        <p>
          A <code>@context</code> B is <a>merged</a> into an original <code>@context</code> A by:
        </p>
        <ol>
          <li><a title="merged">merge</a> the object value of A with B using empty objects if none exists.</li>
          <li>If the resulting object is empty, the merged value is the string <code>http://www.w3.org/ns/csvw</code>.</li>
          <li>Otherwise, the merged value is an array of <code>http://www.w3.org/ns/csvw</code> and the merged object.</li>
        </ol>
<pre class="example highlight" title="TableGroup definition with string @context">
{
  "@context": "http://www.w3.org/ns/csvw",
  "@type": "TableGroup",
  "resources": []
}
</pre>
<pre class="example highlight" title="TableGroup definition with local @context">
{
  "@context": [
    "http://www.w3.org/ns/csvw",
    {
      "@language": "en"
    }
  ],
  "@type": "TableGroup",
  "resources": []
}
</pre>
      </section>
      <section>
        <h3>Common Properties</h3>
        <p>
          Descriptions of groups of tables, tables, schemas, columns, rows and cells MAY contain any <dfn title="common property">properties</dfn> whose names are either absolute URLs or prefixed names. For example, a table description may contain <code>dc:description</code>, <code>dcat:keyword</code> or <code>schema:copyrightHolder</code> properties to provide a description, keywords or the name of the copyright holder, as defined in <a href="http://dublincore.org/documents/2010/10/11/dcmi-terms/#elements-description">Dublin Core Terms</a>, <a href="http://www.w3.org/TR/vocab-dcat/#Property:dataset_keyword">DCAT</a> or <a href="http://schema.org/copyrightHolder">schema.org</a>.
        </p>
        <p>
          The same prefixes are pre-defined as for [[rdfa-core]] within the <a href="http://www.w3.org/2011/rdfa-context/rdfa-1.1">RDFa 1.1 Initial Context</a> and MUST NOT be overridden. Properties from other vocabularies MUST be defined using full URLs.
        </p>
        <p class="note">
          Forbidding the declaration of new prefixes ensures consistent processing between JSON-LD-aware and non-JSON-LD-aware processors.
        </p>
        <div class="issue" data-number="142">
          <p>The values of <a title="common property">common properties</a> may be represented as a string, native JSON type, <cite><a href="">JSON-LD Value Object</a></cite> [[!JSON-LD]], or an array of any of these. Otherwise, if used as strings, when represented as RDF, values will take on the result of <cite><a href="http://www.w3.org/TR/rdf11-concepts/#dfn-simple-literal">simple literal</a></cite> or <cite><a href="http://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">language-tagged string</a></cite> [[rdf-concepts]]. For example:</p>
<pre><code>{
  "dc:title": "String value with possible language from `@context`",
  "dc:description": {"@value": "String value with no language"},
  "schema:name": {"@value": "String value with explicit language", "@language": "en"},
  "schema:url": {"@id": "http://example.com/"},
  "schema:valueRequired": true,
  "foaf:age": 18.5,
  "schema:description": ["first value", "second value"]
}</code></pre>
          <p>Alternatively, value expansion may be determined through custom JSON-LD Context mappings, or by pre-defining specific mappings in the default context. This also has merge considerations, where the <a>object property</a> allowing arrays is not appropriate.</p>
          <p>Merge should be that of <a>atomic property</a> allowing arrays, not presently defined; i.e., coerce values to array, and concatenate unique values in order.</p>
        </div>
      </section>
      <section>
        <h3>Table Groups</h3>
        <p>
          A <dfn>table group description</dfn> is a JSON object that describes a group of tables.
        </p>
        <section>
          <h4>Required Properties</h4>
          <dl>
            <dt id="table-group-resources"><code>resources</code></dt>
            <dd>
              <p>An <a>array property</a> of <a title="table description">table descriptions</a> for the tables in the group. When an array of table descriptions B is <a>merged</a> into an original array of table descriptions A, each table description within B is combined into the original array A by:</p>
              <ul>
                <li>if there is a table description with the same <code>url</code> in A, the table description from B is <a>merged</a> into the matching table description in A</li>
                <li>otherwise, the table description from B is appended to the array of table descriptions A</li>
              </ul>
            </dd>
          </dl>
        </section>
        <section>
          <h4>Optional Properties</h4>
          <p>
            The description of a group of tables MAY also contain:
          </p>
          <dl>
            <dt id="table-group-schema"><code>tableSchema</code></dt>
            <dd>
              <p>An <a>object property</a> that provides a single <a>schema description</a> as described in <a href="#schemas" class="sectionRef"></a>, for all the tables in the group. This may be provided as an embedded object within the JSON metadata or as a URL reference to a separate JSON schema document.</p>
            </dd>
            <dt id="table-group-direction"><code>table-direction</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that MUST have a single string value that is one of <code>"rtl"</code>, <code>"ltr"</code> or <code>"default"</code>. Indicates whether the tables in the group should be displayed with the first column on the right, on the left, or based on the first character in the table that has a specific direction. See <a href="#bidirectional-tables" class="sectionRef"></a> for more details.
              </p>
              <p class="issue" data-number="51">
                This should be a defined controlled vocabulary in JSON-LD, so that the values map on to URIs in the RDF version rather than strings. We invite comment on how to configure the JSON-LD context to enable these values to be interpreted in this way.
              </p>
            </dd>
            <dt id="table-group-dialect"><code>dialect</code></dt>
            <dd>
              <p>An <a>object property</a> that provides a single <a>dialect description</a>. If provided, <code>dialect</code> provides hints to processors about how to parse the referenced files for to create tabular data models for the tables in the group. This may be provided as an embedded object or as a URL reference. See <a href="#dialect-descriptions" class="sectionRef"></a> for more details.</p>
            </dd>
            <dt id="table-group-templates"><code>templates</code></dt>
            <dd>
              <p>An <a>array property</a> of <a title="template specification">template specifications</a> that provide mechanisms to transform the tabular data into other formats. See <a href="#template-specifications" class="sectionRef"></a> for more details. When an array of template specifications B is <a>merged</a> into an original array of template specifications A, each template specification within B is combined into the original array A by:</p>
              <ul>
                <li>if there is a template specification with the same <code>url</code>, <code>targetFormat</code> and <code>templateFormat</code> in A, the template specification from B is <a>merged</a> into the matching template specification in A</li>
                <li>otherwise, the template specification from B is appended to the array of template specifications A</li>
              </ul>
            </dd>
            <dt id="table-group-ld-id"><code>@id</code></dt>
            <dd>
              If included, <code>@id</code> identifies the <a>table group description</a>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.
            </dd>
            <dt id="table-group-ld-type"><code>@type</code></dt>
            <dd>
              <p>If included, <code>@type</code> MUST be set to <code>"TableGroup"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
          </dl>
          <p>
            The description MAY contain any <a title="common property">common properties</a> to provide extra metadata about the set of tables as a whole.
          </p>
          <p>
            The description MAY contain <a title="inherited property">inherited properties</a> to describe cells within the tables.
          </p>
          <p class="issue" data-number="22">
            This issue relates to the use of type vs datatype as a column property. (This issue seems moot now that neither are included.)
          </p>
        </section>
      </section>
      <section>
        <h3>Tables</h3>
        <p>
          A <dfn>table description</dfn> is a JSON object that describes a table within a CSV file.
        </p>
        <p class="issue" data-number="50">
          A CSV file might not be the same as the table that it contains. For example, a given CSV file might contain two tables (in different regions of the CSV file), or might contain a table that isn't positioned at the top left of the CSV file. We invite comment about whether we should assume that pre-processing is used to extract tables where there isn't a 1:1 correspondence between CSV file and table, or not.
        </p>
        <section>
          <h4>Required Properties</h4>
          <dl>
            <dt id="table-url"><code>url</code></dt>
            <dd>
              <p>
                This <a>link property</a> gives the single URL of the CSV file that the table is held in, relative to the location of the metadata document.
              </p>
            </dd>
          </dl>
        </section>
        <section>
          <h4>Optional Properties</h4>
          <p>
            The description of a table MAY also contain:
          </p>
          <dl>
            <dt id="table-schema"><code>tableSchema</code></dt>
            <dd>
              <p>An <a>object property</a> that provides a single <a>schema description</a> as described in <a href="#schemas" class="sectionRef"></a>. This may be provided as an embedded object within the JSON metadata or as a URL reference to a separate JSON schema document.</p>
            </dd>
            <dt id="table-notes"><code>notes</code></dt>
            <dd>
              <p>
                An <a>object property</a> that provides an array of objects representing annotations. This specification does not place any constraints on the structure of these objects.
              </p>
              <p class="note">
                The <a href="http://www.w3.org/annotation/">Web Annotation Working Group</a> is developing a vocabulary for expressing annotations. In future versions of this specification, we anticipate referencing that vocabulary.
              </p>
              <p class="issue" data-number="70">
                Should there be column or level notes as well?
              </p>
              <p class="issue" data-number="71">
                The Annotation Model can indeed become very complex.
              </p>
            </dd>
            <dt id="table-title"><code>title</code></dt>
            <dd>
              <p>A <a>natural language property</a> that describes the title of the table.</p>
            </dd>
            <dt id="table-direction"><code>table-direction</code></dt>
            <dd><p>As defined for <a href="#table-group-direction">table groups</a>.</p></dd>
            <dt id="table-templates"><code>templates</code></dt>
            <dd><p>As defined for <a href="#table-group-templates">table groups</a>.</p></dd>
            <dt id="table-dialect"><code>dialect</code></dt>
            <dd><p>As defined for <a href="#table-group-dialect">table groups</a>.</p></dd>
            <dt id="table-ld-id"><code>@id</code></dt>
            <dd>
              <p>If included, <code>@id</code> identifies the <a>table description</a>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
            <dt id="table-ld-type"><code>@type</code></dt>
            <dd>
              <p>If included, <code>@type</code> MUST be set to <code>"Table"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
          </dl>
          <p class="issue" data-numer="52">
            We invite comment on whether we should include properties that help in checking the integrity of the file: datapackage includes <code>bytes</code> and <code>hash</code>. We could reuse the <a href="http://www.w3.org/TR/SRI/">Subresource Integrity</a> work here.
          </p>
          <p>
            The description MAY contain any <a title="common property">common properties</a> to provide extra metadata about the table as a whole.
          </p>
          <p>
            The description MAY contain <a title="inherited property">inherited properties</a> to describe cells within the table.
          </p>
        </section>
      </section>
      <section>
        <h3>Dialect Descriptions</h3>
        <p>
          Much of the tabular data that is published on the web is messy, and CSV parsers frequently need to be configured in order to correctly read in CSV. A <dfn>dialect description</dfn> provides hints to parsers about how to parse the file linked to from the <code>url</code> property. It can have any of the following properties, which relate to the flags described in <a href="http://www.w3.org/TR/tabular-data-model/#parsing">Section 5 Parsing Tabular Data</a> within [[!tabular-data-model]]:
        </p>
        <dl>
          <dt id="dialect-encoding"><code>encoding</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-encoding">encoding</a> flag to the single provided string value, which MUST be a defined [[!encoding]].</p>
          </dd>
          <dt id="dialect-lineTerminator"><code>lineTerminator</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-line-terminator">line terminator</a> flag to the single provided string value.</p>
          </dd>
          <dt id="dialect-quoteChar"><code>quoteChar</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-quote-character">quote character</a> flag to the single provided value, which MUST be a single character.</p>
          </dd>
          <dt id="dialect-doubleQuote"><code>doubleQuote</code></dt>
          <dd>
            <p>A single boolean <a>atomic property</a> that, if <code>true</code>, sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-escape-character">escape character</a> flag to <code>"</code>. If <code>false</code>, to <code>\</code>.</p>
          </dd>
          <dt id="dialect-skipRows"><code>skipRows</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-skip-rows">skip rows</a> flag to the single provided numeric value, which MUST be a non-negative integer.</p>
          </dd>
          <dt id="dialect-commentPrefix"><code>commentPrefix</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-comment-prefix">comment prefix</a> flag to the single provided value, which MUST be a single character string.</p>
          </dd>
          <dt id="dialect-header"><code>header</code></dt>
          <dd>
            <p>A single boolean <a>atomic property</a> that, if <code>true</code>, sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-header-row-count">header row count</a> flag to <code>1</code>, and if <code>false</code> to <code>0</code>, unless <a href="#dialect-headerRowCount"><code>headerRowCount</code></a> is provided, in which case the value provided for the <code>header</code> property is ignored.</p>
          </dd>
          <dt id="dialect-headerRowCount"><code>headerRowCount</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-header-row-count">header row count</a> flag to the single provided value, which MUST be a non-negative integer.</p>
          </dd>
          <dt id="dialect-delimiter"><code>delimiter</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-delimiter">delimiter</a> flag to the single provided value, which MUST be a single character string.</p>
          </dd>
          <dt id="dialect-skipColumns"><code>skipColumns</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-skip-columns">skip columns</a> flag to the single provided numeric value, which MUST be a non-negative integer.</p>
          </dd>
          <dt id="dialect-headerColumnCount"><code>headerColumnCount</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-header-column-count">header column count</a> flag to the single provided value, which MUST be non-negative integer.</p>
          </dd>
          <dt id="dialect-skipBlankRows"><code>skipBlankRows</code></dt>
          <dd>
            <p>An <a>atomic property</a> that sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-skip-blank-rows">skip blank rows</a> flag to the single provided boolean value.</p>
          </dd>
          <dt id="dialect-skipInitialSpace"><code>skipInitialSpace</code></dt>
          <dd>
            <p>A single boolean <a>atomic property</a> that, if <code>true</code>, sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-trim">trim</a> flag to <code>"start"</code>. If <code>false</code>, to <code>false</code>. If the <a href="#dialect-trim"><code>trim</code></a> property is provided, the <code>skipInitialSpace</code> property is ignored.</p>
          </dd>
          <dt id="dialect-trim"><code>trim</code></dt>
          <dd>
            <p>A single <a>atomic property</a> that, if the boolean <code>true</code>, sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-trim">trim</a> flag to <code>true</code> and if the boolean <code>false</code> to <code>false</code>. If the value provided is a string, sets the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-trim">trim</a> flag to the provided value, which MUST be one of <code>"true"</code>, <code>"false"</code>, <code>"start"</code> or <code>"end"</code>.</p>
          </dd>
          <dt id="dialect-ld-id"><code>@id</code></dt>
          <dd>
            <p>If included, <code>@id</code> identifies the <a>dialect description</a>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
          </dd>
          <dt id="dialect-ld-type"><code>@type</code></dt>
          <dd>
            <p>If included, <code>@type</code> MUST be set to <code>"Dialect"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
          </dd>
        </dl>
        <p class="note">
          Dialect descriptions do not provide a mechanism for handling CSV files in which there are multiple tables within a single file (eg separated by empty lines).
        </p>
        <p>The <a>property value</a> of a <a>dialect description</a> is that defined in the <a>table description</a>, if any, or that defined in the <a>table group description</a>, if any, or the default defined for that property.</p>
        <div class="example">
          <p>
            The default dialect description for CSV files is:
          </p>
          <pre>
{
  "encoding": "utf-8",
  "lineTerminator": "\r\n",
  "quoteChar": "\"",
  "doubleQuote": true,
  "skipRows": 0,
  "header": true,
  "headerRowCount": 1,
  "delimiter": ",",
  "skipColumns": 0,
  "headerColumnCount": 0,
  "skipBlankRows": false,
  "skipInitialSpace": false,
  "trim": false
}
          </pre>
        </div>
      </section>
      <section>
        <h3>Template Specifications</h3>
        <p>
          A <dfn>template specification</dfn> is a definition of how tabular data can be transformed into another format. It has the following properties:
        </p>
        <section>
          <h4>Required Properties</h4>
          <p>
            Template specifications MUST have the following properties:
          </p>
          <dl>
            <dt id="template-url"><code>url</code></dt>
            <dd>
              <p>
                A <a>link property</a> giving the single URL of the file that the template is held in, relative to the location of the metadata document.
              </p>
            </dd>
            <dt id="template-targetFormat"><code>targetFormat</code></dt>
            <dd>
              <p>
                A <a>link property</a> giving the single URL for the format that will be created through the transformation. If one has been defined, this should be a URL for a media type, in the form <code>http://www.iana.org/assignments/media-types/<var>media-type</var></code> such as <code>http://www.iana.org/assignments/media-types/text/calendar</code>. Otherwise, it can be any URL that describes the target format.
              </p>
              <p class="note">
                The <code>targetFormat</code> URL is intended as an informative identifier for the target format, and applications SHOULD NOT access the URL.
              </p>
            </dd>
            <dt id="template-templateFormat"><code>templateFormat</code></dt>
            <dd>
              <p>
                A <a>link property</a> giving the single URL for the format that is used by the template. If one has been defined, this should be a URL for a media type, in the form <code>http://www.iana.org/assignments/media-types/<var>media-type</var></code> such as <code>http://www.iana.org/assignments/media-types/application/javascript</code>. Otherwise, it can be any URL that describes the template format.
              </p>
              <p class="note">
                The <code>templateFormat</code> URL is intended as an informative identifier for the template format, and applications SHOULD NOT access the URL. The template formats that an application supports are implementation defined.
              </p>
            </dd>
          </dl>
        </section>
        <section>
          <h4>Optional Properties</h4>
          <p>
            Template specifications MAY have the following properties:
          </p>
          <dl>
            <dt id="template-title"><code>title</code></dt>
            <dd>
              <p>A <a>natural language property</a> that describes the format that will be generated from the transformation. This is useful if the target format is a generic format (such as <code>application/json</code>) and the transformation is creating a specific profile of that format.</p>
            </dd>
            <dt id="template-source"><code>source</code></dt>
            <dd>
              <p>A single string <a>atomic property</a> that provides, if included, the format to which the tabular data should be transformed prior to the transformation using the template. If the value is <code>"json"</code>, the tabular data should first be transformed first to JSON based on the simple mapping defined in <a href="http://www.w3.org/TR/csv2json/">Generating JSON from Tabular Data on the Web</a>. If the value is <code>"rdf"</code>, it should similarly first be transformed to to an RDF graph based on the simple mapping defined in <a href="http://www.w3.org/TR/csv2rdf/">Generating RDF from Tabular Data on the Web</a>. If the <code>source</code> property is missing or <code>null</code> then the source of the transformation is the annotated tabular data model.
            </dd>
            <dt id="template-ld-id"><code>@id</code></dt>
            <dd>
              <p>If included, <code>@id</code> identifies the <a>template specification</a>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
            <dt id="template-ld-type"><code>@type</code></dt>
            <dd>
              <p>If included, <code>@type</code> MUST be set to <code>"Template"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
          </dl>
          <p>
            The template specification MAY contain any <a title="common property">common properties</a> to provide extra metadata about the transformation.
          </p>
        </section>
        <section>
          <h4>Example</h4>
          <p>
            The following template specification will enable a processor that supports it to generate an iCalendar document using a <a href="https://mustache.github.io/">Mustache template</a> based on the JSON created from the simple mapping to JSON.
          </p>
          <pre class="example">
{
  "url": "templates/ical.txt",
  "title": "iCalendar",
  "targetFormat": "http://www.iana.org/assignments/media-types/text/calendar",
  "templateFormat": "https://mustache.github.io/",
  "source": "json"
} 
          </pre>
        </section>
      </section>
      <section>
        <h3>Schemas</h3>
        <p>
          A <dfn>tableSchema</dfn> is a definition of a tabular format that may be common to multiple tables. For example, multiple tables from different sources may have the same columns and be designed such that they can be aggregated together.
        </p>
        <p>
          A <dfn>schema description</dfn> is a JSON object that encodes the information about a schema. All the properties of a schema description are optional.
        </p>
        <dl>
          <dt id="schema-columns"><code>columns</code></dt>
          <dd>
            <p>
              An <a>array property</a> of <a title="column description">column descriptions</a> as described in <a href="#columns" class="sectionRef"></a>. These are matched to columns in tables that use the schema by position: the first column description in the array applies to the first column in the table, the second to the second and so on.
            </p>
            <p>
              The <a href="#column-name"><code>name</code></a> properties of the column descriptions MUST be unique within a given table description.
            </p>
            <p>
              When an array of column descriptions B is <a>merged</a> into an original array of column descriptions A, each column description within B is combined into the original array A by:
            </p>
            <ul>
              <li>if there is a column description at the same index within A and that column description has the same <code>name</code>, the column description from B is <a>merged</a> into the matching column description in A</li>
              <li>otherwise, if there is a column description at the same index within A with a <code>title</code> that is also a <code>title</code> in A, considering the language of each <code>title</code> where <code>und</code> matches a value in any language, the column description from B is imported into the matching column description in A.</li>
              <li>otherwise, if there is no column description at the same index within A, then the column description is taken from that index of B</li>
              <li>otherwise, the column description is ignored. A validator MUST issue a warning if such a column description is encountered.</li>
            </ul>
          </dd>
          <dt id="table-primaryKey"><code>primaryKey</code></dt>
          <dd>
            <p>
              A <a>column reference property</a> that holds either a single reference to a column description object or an array of references.
            </p>
            <p>
              <a>Validators</a> MUST check that each row has a unique combination of cells in the indicated columns. For example, if <code>primaryKey</code> is set to <code>["familyName", "givenName"]</code> then every row must have a unique value for the combination of the <code>familyName</code> and <code>givenName</code> columns.
            </p>
            <p class="issue" data-number="66">
              Composite primary keys and foreign key references.
            </p>
          </dd>
          <dt id="table-foreignKeys"><code>foreignKeys</code></dt>
          <dd>
            <p>
              An <a>array property</a> of <a title="foreign key definition">foreign key definitions</a> that define how the values from specified columns within this table link to rows within this table or other tables. A <dfn>foreign key definition</dfn> is a JSON object with the properties:
            </p>
            <dl>
              <dt id="foreign-key-columns"><code>columns</code></dt>
              <dd>
                <p>A <a>column reference property</a> that holds either a single reference to a column description object within this schema, or an array of references.</p>
              </dd>
              <dt id="foreign-key-reference"><code>reference</code></dt>
              <dd>
                <p>
                  An object with the properties:
                </p>
                <dl>
                  <dt id="foreign-key-reference-resource"><code>resource</code></dt>
                  <dd>
                    <p>A <a>link property</a> holding a URL that is the identifier for a specific resource that is being referenced. If this is present then <code>tableSchema</code> MUST NOT be present. The metadata document MUST contain a description of the resource.</p>
                  </dd>
                  <dt id="foreign-key-reference-schema"><code>tableSchema</code></dt>
                  <dd>
                    <p>A <a>link property</a> holding a URL that is the identifier for a schema that is being referenced. If this is present then <code>resource</code> MUST NOT be present. The metadata document that forms the basis of processing MUST contain a description of a resource that uses the referenced schema, and there MUST NOT be more than one such resource.</p>
                  </dd>
                  <dt id="foreign-key-reference-columns"><code>columns</code></dt>
                  <dd>
                    <p>A <a>column reference property</a> that holds either a single reference to a column description object within this schema, or an array of references.</p>
                  </dd>
                </dl>
              </dd>
            </dl>
            <p class="note">
              It is not required for the resource or schema referenced from a <code>foreignKeys</code> property to have a similarly defined <code>primaryKey</code>.
            </p>
            <p>
              When an array of foreign key definitions B is <a>merged</a> into an original array of foreign key definitions A, each foreign key definition within B which does not appear within A is appended to the original array A.
            </p>
            <p class="issue" data-number="16">
              The cross reference between files should be limited to files from one publisher - else they are just web links with no guarantee of whether the target of the link exists which 'foreign key' might imply.
            </p>
          </dd>
          <dt id="schema-ld-id"><code>@id</code></dt>
          <dd>
            <p>If included, <code>@id</code> identifies the <a>schema description</a>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
          </dd>
          <dt id="schema-ld-type"><code>@type</code></dt>
          <dd>
            <p>If included, <code>@type</code> MUST be set to <code>"Schema"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
          </dd>
        </dl>
        <p>
          The description MAY contain any <a title="common property">common properties</a> to provide extra metadata about the schema as a whole.
        </p>
        <p>
          The description MAY contain <a title="inherited property">inherited properties</a> to describe cells within the table.
        </p>
        <section>
          <h4>Examples</h4>
          <section>
            <h5>Foreign Key Reference Between Resources</h5>
            <p>
              A list of countries is published at <code>http://example.org/countries.csv</code> with the structure:
            </p>
            <pre class="example highlight">
countryCode,latitude,longitude,name
AD,42.546245,1.601554,Andorra
AE,23.424076,53.847818,"United Arab Emirates"
AF,33.93911,67.709953,Afghanistan
            </pre>
            <p>
              Another file contains information about the population in some countries each year, at <code>http://example.com/country_slice.csv</code> with the structure:
            </p>
            <pre class="example highlight">
countryRef,year,population
AF,1960,9616353
AF,1961,9799379
AF,1962,9989846
            </pre>
            <p>
              The following metadata for the group of tables links the two together by defining a <code>foreignKeys</code> property:
            </p>
            <pre class="example highlight">
{
  "@context": "http://www.w3.org/ns/csvw",
  "resources": [{
    "url": "https://example.org/countries.csv",
    "tableSchema": {
      "columns": [{
        "name": "countryCode",
        "datatype": "string"
      }, {
        "name": "latitude",
        "datatype": "number"
      }, {
        "name": "longitude",
        "datatype": "number"
      }, {
        "name": "name",
        "datatype": "string"
      }],
      "aboutUrl": "http://example.org/countries.csv{#countryCode}",
      "primaryKey": "countryCode"
    }
  }, {
    "url": "http://example.com/country_slice.csv",
    "tableSchema": {
      "columns": [{
        "name": "countryRef",
        "datatype": "string"
      }, {
        "name": "year",
        "datatype": "gYear"
      }, {
        "name": "population",
        "datatype": "integer"
      }],
      "foreignKeys": [{
        "columns": "countryRef",
        "reference": {
          "resource": "http://example.org/countries.csv",
          "columns": "countryCode"
        }
      }]
    }
  }]
}
            </pre>
            <p>
              When the population data in <code>country_slice.csv</code> is processed (displayed or mapped into another format), a link can be made from the content of the <code>countryRef</code> column based on the <code>aboutUrl</code> for <code>country.csv</code>. For example, if the <code>countryRef</code> column (the value of <code>columns</code> in the <code>foreignKeys</code> object) in <code>country_slice.csv</code> contains the value <code>UK</code> then the processor will use that value to populate the <code>countryCode</code> variable (the value of <code>reference.columns</code> in the <code>foreignKeys</code> object) when interpreting the <code>aboutUrl</code> for <code>country.csv</code>, and create the URL <code>http://example.org/countries.csv#UK</code>. The processor does not need to retrieve <code>http://example.org/countries.csv</code> or check that the value <code>UK</code> appears within the <code>countryCode</code> column to create this link: it is created purely based on the <code>aboutUrl</code> in the description of the referenced resource.
            </p>
          </section>
          <section>
            <h4>Foreign Key Reference Between Schemas</h4>
            <p>
              When publishing information about public sector roles and salaries, as in <a href="http://w3c.github.io/csvw/csvw-ucr/#UC-OrganogramData">Use Case 4</a>, the UK government requires departments to publish two files which are interlinked. The first lists senior grades (simplified here) eg at <code>HEFCE_organogram_senior_data_31032011.csv</code>:
            </p>
            <pre class="example">
Post Unique Reference,              Name,Grade,             Job Title,Reports to Senior Post
                90115,        Steve Egan,SCS1A,Deputy Chief Executive,                 90334
                90250,     David Sweeney,SCS1A,              Director,                 90334
                90284,       Heather Fry,SCS1A,              Director,                 90334
                90334,Sir Alan Langlands, SCS4,       Chief Executive,                    xx
            </pre>
            <p>
              The second provides information about the number of junior positions that report to those individuals (simplified here) eg at <code>HEFCE_organogram_junior_data_31032011.csv</code>:
            </p>
            <pre class="example">
Reporting Senior Post,Grade,Payscale Minimum (£),Payscale Maximum (£),Generic Job Title,Number of Posts in FTE,          Profession
                90284,    4,               17426,               20002,    Administrator,                     2,Operational Delivery
                90284,    5,               19546,               22478,    Administrator,                     1,Operational Delivery
                90115,    4,               17426,               20002,    Administrator,                  8.67,Operational Delivery
                90115,    5,               19546,               22478,    Administrator,                   0.5,Operational Delivery
            </pre>
            <p>
              The schemas are reused by multiple departments and for multiple pairs of files. The schemas are therefore defined in separate files, and they need to define links between the schemas which are then picked up as applying between tables that use those schemas.
            </p>
            <p>
              The metadata file for the particular publication of the files above is:
            </p>
            <pre class="example highlight">
{
  "@context": "http://www.w3.org/ns/csvw",
  "resources": [{
    "url": "HEFCE_organogram_senior_data_31032011.csv",
    "tableSchema": "http://example.org/schema/senior-roles.json"
  }, {
    "url": "HEFCE_organogram_junior_data_31032011.csv",
    "tableSchema": "http://example.org/schema/junior-roles.json"
  }]
}
            </pre>
            <p>
              The schema for the senior role CSV (at <code>http://example.org/schema/senior-roles.json</code>) is as follows; it includes a foreign key reference to itself:
            </p>
            <pre class="example highlight">
{
  "@context": "http://www.w3.org/ns/csvw",
  "url": "http://example.org/schema/senior-roles.json",
  "columns": [{
    "name": "ref",
    "title": "Post Unique Reference"
  }, {
    "name": "name",
    "title": "Name"
  }, {
    "name": "grade",
    "title": "Grade"
  }, {
    "name": "job",
    "title": "Job Title"
  }, {
    "name": "reportsTo",
    "title": "Reports to Senior Post"
  }],
  "primaryKey": "ref",
  "aboutUrl": "#post-{ref}",
  "foreignKeys": [{
    "columns": "reportsTo",
    "reference": {
      "tableSchema": "http://example.org/schema/senior-roles.json",
      "columns": "ref"
    }
  }]
}
            </pre>
            <p>
              The schema for the junior role CSV (at <code>http://example.org/schema/junior-roles.json</code>) is as follows; it includes a foreign key reference to the senior roles schema:
            </p>
            <pre class="example highlight">
{
  "@context": "http://www.w3.org/ns/csvw",
  "url": "http://example.org/schema/junior-roles.json",
  "columns": [{
    "name": "reportsTo",
    "title": "Reporting Senior Post"
  }, 
  ...
  ],
  "foreignKeys": [{
    "columns": "reportsTo",
    "reference": {
      "tableSchema": "http://example.org/schema/senior-roles.json",
      "columns": "ref"
    }
  }]
}
            </pre>
            <p>
              In the first line of <code>HEFCE_organogram_junior_data_31032011.csv</code>, the <code>reportsTo</code> (<code>Reporting Senior Post</code>) column contains the value <code>90284</code>. When creating a link from that column, the <code>aboutUrl</code> defined within the schema at <code>http://example.org/schema/senior-roles.json</code> is used to generate a URL by expanding the variable reference for <code>ref</code> based on the value from the <code>reportsTo</code> column. This gives the relative URL <code>#post-90284</code> which is then resolved against the base URL of the resource that uses the <code>senior-roles.json</code> schema within the original metadata file, namely <code>HEFCE_organogram_senior_data_31032011.csv</code>.
            </p>
          </section>
        </section>
      </section>
      <section>
        <h3>Columns</h3>
        <p>
          A <dfn>column description</dfn> is a simple JSON object that describes a single column. The description provides additional human-readable documentation for a column, as well as additional information that may be used to validate the cells within the column, create a user interface for data entry, or inform conversion into other formats.
        </p>
        <p class="issue" data-number="64">
          Should there be a way to suppress columns?
        </p>
        <section>
          <h4>Optional Properties</h4>
          <dl>
            <dt id="column-name"><code>name</code></dt>
            <dd>
              <p>
                An <a>atomic property</a> that gives a single canonical name for the column. This MUST be a string. Conversion specifications MUST use this property as the basis for the names of properties/elements/attributes in the results of conversions.
              </p>
              <p>The <a>property value</a> of <code>name</code> is that defined within metadata, if it exists. Otherwise, it is the first value from the <a>property value</a> of <code>title</code> having the same language tag as <a>default language</a> or <code>und</code> of not specified percent-encoded as necessary to conform to the syntactic requirements described below, as a string without language, if any. Otherwise, it is the string <code>"_col.<em>[N]</em>"</code> where <code><em>[N]</em></code> is the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-column-number">column number</a>.
              </p>
              <p>
                For ease of reference within <a title="URI template property">URI template properties</a>, column names MUST consist only of alphanumeric characters, underscores, or <code>"."</code> (<code>[a-zA-Z0-9][a-zA-Z0-9_\.]*</code>). Names beginning with <code>"_"</code> or  <code>"."</code> are reserved by this specification and MUST NOT be used.
              </p>
              <p class="issue" data-number="53">
                We invite comment on what the syntactic limitations should be on column names to make them most useful when used as the basis of conversion into other formats, bearing in mind that different target languages such as JSON, RDF and XML have different syntactic limitations and common naming conventions.
              </p>
              <p>
                During validation, if there is no <code>title</code> property and the column already has a <code>title</code> annotation then a validator MUST issue a warning if the existing <code>title</code> annotation does not match the <code>name</code> specified in the column description.
              </p>
            </dd>
            <dt id="column-title"><code>title</code></dt>
            <dd>
              <p>
                A <a>natural language property</a> that provides possible alternative names for the column.
              </p>
              <p class="issue" data-number="56">
                The facility to specify multiple potential titles for a column is important when the same column description is used for multiple CSVs, through a mechanism yet to be defined by this specification.
              </p>
            </dd>
            <dt id="column-required"><code>required</code></dt>
           <dd><p>A boolean <a>atomic property</a> taking a single value which indicates whether every cell within the column must have a non-null value. Its <a>property value</a> is that defined in metadata, or <code>false</code> otherwise.</p></dd>
            <dt id="column-virtual"><code>virtual</code></dt>
            <dd>
              <p>A boolean <a>atomic property</a> taking a single value which indicates whether the column is a <a href="http://www.w3.org/TR/tabular-data-model/#dfn-virtual-columns" class="externalDFN">virtual column</a> not present in the original source. If present, a virtual column MUST appear after all other column definitions</p>
              <p class="note">Virtual columns are useful for inserting cells into an <a href="http://www.w3.org/TR/tabular-data-model/#dfn-annotated-table" class="externalDFN">annotated table</a>.</p>
              <p class="issue" data-number="179">We invite comment on whether <a href="http://www.w3.org/TR/tabular-data-model/#dfn-virtual-columns" class="externalDFN">virtual columns</a> are useful enough to include in the final recommendation in spite of the added complexity.</p>
            </dd>
            <dt id="column-ld-id"><code>@id</code></dt>
            <dd>
              <p>If included, <code>@id</code> identifies the <a>column description</a>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.</p>
            </dd>
            <dt id="column-ld-type"><code>@type</code></dt>
            <dd>
              <p>
                If included, <code>@type</code> MUST be set to <code>"Column"</code>. Publishers MAY include this to provide additional information to JSON-LD based toolchains.
              </p>
            </dd>
          </dl>
          <p>
            The description MAY contain any <a title="common property">common properties</a> to provide extra metadata about the column as a whole, such as a full description.
          </p>
          <p>
            The description MAY contain <a title="inherited property">inherited properties</a> to describe cells within the column.
          </p>
        </section>
      </section>
      <section>
        <h2>Inherited Properties</h2>
        <p>
          Cell descriptions may override <a title="inherited property">inherited properties</a>, as described in <a href="#annotating-tables" class="sectionRef"></a>. It is good practice to define these properties on columns, so that all cells within a given column are handled in the same way, or on tables if appropriate. These properties are:
        </p>
        <dl>
          <dt id="cell-empty-value"><code>null</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> giving the string or strings used for null values. If not specified, the default for this is the empty string.
            </p>
          </dd>
          <dt id="cell-language"><code>lang</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> giving a single string language code as defined by [[!BCP47]]. Indicates the language of the value within the cell.
            </p>
          </dd>
          <dt id="cell-text-direction"><code>text-direction</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that MUST have a single string value that is one of <code>"rtl"</code> or <code>"ltr"</code> (the default). Indicates whether the text within cells should be displayed by default as left-to-right or right-to-left text. See <a href="#bidirectional-tables" class="sectionRef"></a> for more details.
            </p>
          </dd>
          <dt id="cell-separator"><code>separator</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that MUST have a single string value that is the character used to separate items in the string value of the cell. If <code>null</code> or unspecified, the cell does not contain a list. Otherwise, application MUST split the string value of the cell on the specified separator character and parse each of the resulting strings separately. The cell's value will then be a list. Conversion specifications MUST use the separator to determine the conversion of a cell into the target format. See <a href="#parsing-cells"></a> for more details.
            </p>
          </dd>
          <dt id="cell-default"><code>default</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> holding a single string that provides a default string value for the cell in cases where the original string value is a <code>null</code> values. This default value MAY be used when converting the table into other formats.
            </p>
          </dd>
          <dt id="cell-format"><code>format</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single string that is the definition of the format of the cell, used when parsing the cell as described in <a href="#parsing-cells"></a>.
            </p>
          </dd>
          <dt id="cell-datatype"><code>datatype</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single string that is the main datatype of the values of the cell. The value is a term defined in the default context representing a datatype URL. If the cell contains a list (ie <code>separator</code> is specified and not <code>null</code>) then this is the datatype of each value within the list. Conversion specifications MUST use the datatype of the value to determine the conversion of a cell into the target format. See <a href="#datatypes"></a> for more details.
            </p>
          </dd>
          <dt id="cell-aboutUrl"><code>aboutUrl</code></dt>
          <dd>
            <p>A <a>URI template property</a> that MAY be used to create a unique identifier for each cell within a row when mapping data to other formats. See <a href="#converting-tables" class="sectionRef"></a> for details.</p>
            <p class="note"><code>aboutUrl</code> is typically defined on a Schema or Table. If defined on individual Columns, care must be taken to ensure that transformed cell values maintain a semantic relationship.</p>
          </dd>
          <dt id="cell-propertyUrl"><code>propertyUrl</code></dt>
          <dd>
            <p>An <a>URI template property</a> that MAY be used to create a URI for a property if the table is mapped to another format. The default value of <code>propertyUrl</code> is <code>"{#_name}"</code>. See <a href="#converting-tables" class="sectionRef"></a> for details.</p>
            <p class="note"><code>propertyUrl</code> is typically defined on a Column. If defined on a Schema, Table or Table Group, care must be taken to ensure that transformed cell values maintain an appropriate semantic relationship. For example by including the <code>name</code> of the column in the generated URL by using <code>_name</code> in the template.</p>
          </dd>
          <dt id="cell-valueUrl"><code>valueUrl</code></dt>
          <dd>
            <p>An <a>URI template property</a> that is used to map the values to the cells into URLs. See <a href="#parsing-cells" class="sectionRef"></a> for details.</p>
            <p class="note">
              This allows a <a href="http://www.w3.org/TR/tabular-data-model/#dfn-cell-value" class="externalDFN">cell value</a> to define one or more RDF <cite><a href="http://www.w3.org/TR/rdf11-concepts/#dfn-resource">resources</a></cite> value of a cell instead of a literal values, as defined in [[rdf-concepts]]. For example, if the value were <code>"{#reference}"</code>, each cell value of a column named <em>reference</em> would be used to create a URI such as <code>http://example.com/#1234</code>, if <code>1234</code> were a cell value of that column.</p>
            <p class="note"><code>valueUrl</code> is typically defined on a Column. If defined on a Schema, Table or Table Group, care must be taken to ensure that transformed cell values maintain an appropriate semantic relationship.</p>
          </dd>
          <dt id="cell-length"><code>length</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single integer that is the exact length of the value of the cell. See <a href="#length-constraints" class="sectionRef"></a> for details.
            </p>
          </dd>
          <dt id="cell-minLength"><code>minLength</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single integer that is the minimum length of the value of the cell. See <a href="#length-constraints" class="sectionRef"></a> for details.
            </p>
          </dd>
          <dt id="cell-maxLength"><code>maxLength</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single integer that is the maximum length of the value of the cell. See <a href="#length-constraints" class="sectionRef"></a> for details.
            </p>
          </dd>
          <dt id="cell-minimum"><code>minimum</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single number that is the minimum value for the cell (inclusive); equivalent to <code>minInclusive</code>. See <a href="#value-constraints" class="sectionRef"></a> for details.
            </p>
          </dd>
          <dt id="cell-maximum"><code>maximum</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single number that is the maximum value for the cell (inclusive); equivalent to <code>maxInclusive</code>. See <a href="#value-constraints" class="sectionRef"></a> for details.
            </p>
          </dd>
          <dt id="cell-minInclusive"><code>minInclusive</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single number that is the minimum value for the cell (inclusive). See <a href="#value-constraints" class="sectionRef"></a> for details.
            </p>
          </dd>
          <dt id="cell-maxInclusive"><code>maxInclusive</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single number that is the maximum value for the cell (inclusive). See <a href="#value-constraints" class="sectionRef"></a> for details.
            </p>
          </dd>
          <dt id="cell-minExclusive"><code>minExclusive</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single number that is the minimum value for the cell (exclusive). See <a href="#value-constraints" class="sectionRef"></a> for details.
            </p>
          </dd>
          <dt id="cell-maxExclusive"><code>maxExclusive</code></dt>
          <dd>
            <p>
              An <a>atomic property</a> that contains a single number that is the maximum value for the cell (exclusive). See <a href="#value-constraints" class="sectionRef"></a> for details.
            </p>
          </dd>
        </dl>
        <p>The <a>property value</a> of an <a>inherited property</a> is the first value, if any, found by looking in the current annotation object through all of its containing objects: a <a>inherited property</a> defined in a <a>column description</a> takes precidence of one defined in a <a>schema description</a>, which in turn takes precidence of one defined in a <a>table description</a>, which in turn takes precidence of one defined in a <a>table group description</a>.</p>
      </section>
      <section>
        <h2>Datatypes</h2>
        <p>
          Cells within tables may be annotated with a <code>datatype</code> which indicates the type of the value obtained by parsing the value of the cell. The format expected in the cell is determined by the <code>format</code> annotation, if there is one, or uses a default format determined by the type.
        </p>
        <p>
          The possible datatypes are:
        </p>
        <ul>
          <li>
            <p>the datatypes defined in [[!xmlschema-2]] with the exception of those that rely on XML mechanisms for definition, namely:</p>
            <ul>
              <li><code>anySimpleType</code></li>
              <li><code>string</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>normalizedString</code>; a sub-value of <code>string</code></li>
              <li><code>token</code>; a sub-value of <code>normalizedString</code></li>
              <li><code>language</code>; a sub-value of <code>token</code></li>
              <li><code>Name</code>; a sub-value of <code>token</code></li>
              <li><code>NCName</code>; a sub-value of <code>Name</code></li>
              <li><code>boolean</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>decimal</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>integer</code>; a sub-value of <code>decimal</code></li>
              <li><code>nonPositiveInteger</code>; a sub-value of <code>integer</code></li>
              <li><code>negativeInteger</code>; a sub-value of <code>nonPositiveInteger</code></li>
              <li><code>long</code>; a sub-value of <code>integer</code></li>
              <li><code>int</code>; a sub-value of <code>long</code></li>
              <li><code>short</code>; a sub-value of <code>int</code></li>
              <li><code>byte</code>; a sub-value of <code>short</code></li>
              <li><code>nonNegativeInteger</code>; a sub-value of <code>integer</code></li>
              <li><code>unsignedLong</code>; a sub-value of <code>nonNegativeInteger</code></li>
              <li><code>unsignedInt</code>; a sub-value of <code>unsignedLong</code></li>
              <li><code>unsignedShort</code>; a sub-value of <code>unsignedInt</code></li>
              <li><code>unsignedByte</code>; a sub-value of <code>unsignedShort</code></li>
              <li><code>positiveInteger</code>; a sub-value of <code>nonNegativeInteger</code></li>
              <li><code>float</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>double</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>duration</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>dateTime</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>time</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>date</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>gYearMonth</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>gYear</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>gMonthDay</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>gDay</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>gMonth</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>hexBinary</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>base64Binary</code>; a sub-value of <code>anySimpleType</code></li>
              <li><code>anyURI</code>; a sub-value of <code>anySimpleType</code></li>
            </ul>
          </li>
          <li>the datatype <code>number</code> which is exactly equivalent to <code>double</code></li>
          <li>the datatype <code>binary</code> which is exactly equivalent to <code>base64Binary</code></li>
          <li>the datatype <code>datetime</code> which is exactly equivalent to <code>dateTime</code></li>
          <li>the datatype <code>any</code> which is exactly equivalent to <code>anySimpleType</code></li>
          <li>the datatype <code>xml</code> which indicates the cell contains an XML fragment</li>
          <li>the datatype <code>html</code> which indicates the cell contains an HTML fragment</li>
          <li>the datatype <code>json</code> which indicates the cell contains serialized JSON</li>
        </ul>
        <section>
          <h3>Length Constraints</h3>
          <p>
            The <code>length</code>, <code>minLength</code> and <code>maxLength</code> properties indicate the exact, minimum and maximum lengths of the values of cells.
          </p>
          <p>
            Applications MUST raise an error if both <code>length</code> and <code>minLength</code> are specified and they do not have the same value. Similarly, applications MUST raise an error if both <code>length</code> and <code>maxLength</code> are specified and they do not have the same value. Applications MUST raise an error if <code>length</code>, <code>maxLength</code> or <code>minLength</code> are specified and the <a href="http://www.w3.org/TR/tabular-data-model/#dfn-cell-value" class="externalDFN">cell value</a> is not a list (ie <code>separator</code> is not specified), a string or one of its subtypes, or a binary value.
          </p>
          <p>
            The length of a value of a cell is determined as follows:
          </p>
          <ul>
            <li>if the cell is <code>null</code> its length is zero</li>
            <li>if the value is a list, its length is the number of items in the list</li>
            <li>if the value is a string or one of its subtypes, its length is the number of characters in the value</li>
            <li>if the value is of a binary type, its length is the number of bytes in the binary value</li>
          </ul>
        </section>
        <section>
          <h3>Value Constraints</h3>
          <p>
            The <code>minimum</code>, <code>maximum</code>, <code>minInclusive</code>, <code>maxInclusive</code>, <code>minExclusive</code> and <code>maxExclusive</code> properties indicate limits on the values of cells. These apply to numeric and date/time types. The <code>minimum</code> property is equivalent to the <code>minInclusive</code> property and the <code>maximum</code> property is equivalent to the <code>maxInclusive</code> property.
          </p>
          <p>
            Validation against these properties is as defined in [[!xmlschema-2]].
          </p>
        </section>
      </section>
      <section>
        <h2>Parsing cells</h2>
        <p>
          Unlike many other data formats, tabular data is designed to be read by humans. For that reason, it's common for data to be represented within tabular data in a human-readable way. The <a href="#cell-valueUrl"><code>valueUrl</code></a>, <code>separator</code> and <code>format</code> properties indicates the format used to represent data within the table. This is used:
        </p>
        <ul>
          <li>by <strong>validators</strong> to check that the data in the table is in the expected format</li>
          <li>by <strong>converters</strong> to parse the values before mapping them into values in the target of the conversion</li>
          <li>when <strong>displaying</strong> data, to map it into formats that are meaningful for those viewing the data (as opposed to those publishing it)</li>
          <li>when <strong>inputting</strong> data, to turn entered values into representations in a consistent format</li>
        </ul>
        <p>The <strong><a href="http://www.w3.org/TR/tabular-data-model/#dfn-cell-value" class="externalDFN">cell value</a></strong> of a cell is the result of processing the cell as defined here and applying any format-specific mappings to create on or more values. The cell value includes the in-scope <code>lang</code> and <code>datatype</code> <a title="property value">property values</a>.</p>
        <p>
          The process of parsing the string value of a cell into a single value or a list of values is as follows:
        </p>
        <p class="issue" data-number="61">
          What should be the mapping of an empty cell? 
        </p>
        <ol>
          <li>unless the <code>datatype</code> is <code>string</code> or <code>anySimpleType</code> or <code>any</code>, strip leading and trailing whitespace from the value</li>
          <li>if the value is the same as the <code>null</code> value, then the value is <code>null</code></li>
          <li>if the <code>separator</code> property is not <code>null</code>, create a list of values by splitting the string at the character specified by the <code>separator</code> property</li>
          <li>validate the value(s) against the <code>format</code>, if one is specified, as described below; raise an error if any of the values do not match the specified format</li>
          <li>if the cell column has a <a href="#cell-valueUrl"><code>valueUrl</code></a> the value(s) are the result of applying the URI template to each value as described in <a>URI template property</a>.</cite></li>
          <li>parse the value(s) using the <code>format</code>, as described below</li>
        </ol>
        <section>
          <h3>Formats for strings</h3>
          <p>
            If the <code>datatype</code> is a string type, the <code>format</code> property provides a regular expression for the string values, in the syntax and processed as defined by [[!ECMASCRIPT]].
          </p>
          <p class="note">
            Authors are encouraged to be conservative in the regular expressions that they use, sticking to the basic features of regular expressions that are likely to be supported across implementations.
          </p>
        </section>
        <section>
          <h3>Formats for numeric types</h3>
          <p>
            It is not uncommon for numbers within tabular data to be formatted for human consumption, which may involve using commas for decimal points, grouping digits in the number using commas, or adding currency symbols or percent signs to the number.
          </p>
          <p>
            If the <code>datatype</code> is a numeric type, the <code>format</code> property indicates the expected format for that number. <a>Validators</a> MUST check that the numbers in the column adhere to the specified format. <a>Converters</a> MUST use the <code>format</code> property to parse the number when mapping it into a suitable type in the target format of the conversion.
          </p>
          <p>
            When the <code>datatype</code> is a numeric type, the <code>format</code> property's value MUST be either a single string or an object with one or more of the properties:
          </p>
          <dl>
            <dt id="decimalChar"><code>decimalChar</code></dt>
            <dd>A single character string whose value is used to represent a decimal point within the number. The default value is <code>"."</code>.</dd>
            <dt id="groupChar"><code>groupChar</code></dt>
            <dd>A single character string whose value is used to group digits within the number. The default value is <code>","</code>.</dd>
            <dt id="number-pattern"><code>pattern</code></dt>
            <dd>A regular expression string, in the syntax and interpreted as defined by [[!ECMASCRIPT]].</dd>
          </dl>
          <p>
            If the <code>format</code> property is a single string, this is interpreted in the same way as if it were an object with a <code>pattern</code> property whose value is that string.
          </p>
          <p>
            When parsing a value against this format specification, implementations MUST recognise and parse numbers that consist of:
          </p>
          <ol>
            <li>an optional <code>+</code> or <code>-</code> sign</li>
            <li>followed by a decimal digit (<code>0-9</code>)</li>
            <li>followed by any number of decimal digits (<code>0-9</code>) and the character specified as the <a href="#groupChar"><code>groupChar</code></a></li>
            <li>followed by an optional <a href="#decimalChar"><code>decimalChar</code></a> followed by one or more decimal digits (<code>0-9</code>)</li>
            <li>followed by an optional exponent, consisting of an <code>E</code> followed by an optional <code>+</code> or <code>-</code> sign followed by one or more decimal digits (<code>0-9</code>)</li>
            <li>followed by an optional percent (<code>%</code>) or per-mille (<code>&permil;</code>) sign</li>
          </ol>
          <p>
            Implementations MUST raise an error if a number does not meet the format defined above, or if it contains two consecutive <a href="#groupChar"><code>groupChar</code></a> characters, or if it does not match the regular expression defined in the <a href="#number-pattern"><code>pattern</code></a> property, if there is one.
          </p>
          <p>
            <a>Converters</a> MUST use the sign, exponent, percent and per-mille signs when interpreting the number ready for conversion. For example, the string value <code>-25%</code> must be interpreted as <code>-0.25</code> and the string value <code>1E6</code> as <code>1000000</code>.
          </p>
        </section>
        <section>
          <h3>Formats for booleans</h3>
          <p>
            Boolean values may be represented in many ways aside from the standard <code>1</code> and <code>0</code> or <code>true</code> and <code>false</code>.
          </p>
          <p>
            If the <code>datatype</code> is <code>boolean</code>, the <code>format</code> property provides the true and false values expected, separated by <code>|</code>. For example if <code>format</code> is <code>Y|N</code> then cells must hold either <code>Y</code> or <code>N</code> with <code>Y</code> meaning <code>true</code> and <code>N</code> meaning <code>false</code>.
          </p>
          <p>The <a href="http://www.w3.org/TR/tabular-data-model/#dfn-cell-value" class="externalDFN">cell value</a> is one or more <code>true</code> or <code>false</code> values.</p>
        </section>
        <section>
          <h3>Formats for dates and times</h3>
          <p>
            Dates and times are commonly represented in tabular data in formats other than those defined in [[!xmlschema-2]].
          </p>
          <p>
            If the <code>datatype</code> is a date or time type, the <code>format</code> property indicates the expected format for that date or time. <a>Validators</a> MUST check that the dates or times in the column adhere to the specified format. <a>Converters</a> MUST use the <code>format</code> property to parse the date or time when mapping it into a suitable type in the target language of the conversion.
          </p>
          <p>
            The following date formats MUST be recognised by implementations:
          </p>
          <ul>
            <li><code>yyyy-MM-dd</code> eg <code>2015-03-22</code></li>
            <li><code>yyyyMMdd</code> eg <code>20150322</code></li>
            <li><code>dd-MM-yyyy</code> eg <code>22-03-2015</code></li>
            <li><code>d-M-yyyy</code> eg <code>22-3-2015</code></li>
            <li><code>MM-dd-yyyy</code> eg <code>03-22-2015</code></li>
            <li><code>M-d-yyyy</code> eg <code>3-22-2015</code></li>
            <li><code>dd/MM/yyyy</code> eg <code>22/03/2015</code></li>
            <li><code>d/M/yyyy</code> eg <code>22/3/2015</code></li>
            <li><code>MM/dd/yyyy</code> eg <code>03/22/2015</code></li>
            <li><code>M/d/yyyy</code> eg <code>3/22/2015</code></li>
            <li><code>dd.MM.yyyy</code> eg <code>22.03.2015</code></li>
            <li><code>d.M.yyyy</code> eg <code>22.3.2015</code></li>
            <li><code>MM.dd.yyyy</code> eg <code>03.22.2015</code></li>
            <li><code>M.d.yyyy</code> eg <code>3.22.2015</code></li>
          </ul>
          <p>
            The following time formats MUST be recognised by implementations:
          </p>
          <ul>
            <li><code>HH:mm:ss</code> eg <code>15:02:37</code></li>
            <li><code>HHmmss</code> eg <code>150237</code></li>
            <li><code>HH:mm</code> eg <code>15:02</code></li>
            <li><code>HHmm</code> eg <code>1502</code></li>
          </ul>
          <p>
            The following date/time formats MUST be recognised by implementations:
          </p>
          <ul>
            <li><code>yyyy-MM-ddTHH:mm:ss</code> eg <code>2015-03-15T15:02:37</code></li>
            <li>Any of the date formats above, followed by a space, followed by any of the time formats above, eg <code>M/d/yyyy HH:mm</code> for <code>3/22/2015 15:02</code> or <code>dd.MM.yyyy HH:mm:ss</code> for <code>22.03.2015 15:02:37</code></li>
          </ul>
          <p>
            The supported date and time formats listed above are expressed in terms of the <a href="http://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table">date field symbols</a> defined in [[!UAX35]] and should be interpreted by implementations as defined in that specification.
          </p>
          <p>The <a href="http://www.w3.org/TR/tabular-data-model/#dfn-cell-value" class="externalDFN">cell value</a> is one or more dates or times extracted using the <code>format</code>.</p>
          <p class="note">
            For simplicity, this version of this standard does not support abbreviated or full month or day names, or double digit years. Future versions of this standard may support other date and time formats, or general purpose date/time pattern strings. Authors of schemas SHOULD use appropriate regular expressions, along with the <code>string</code> datatype, for dates and times that use a format other than that specified here.
          </p>
          <p class="issue" data-number="65">
            Register of recognised date-time picture string formats.
          </p>
        </section>
        <section>
          <h3>Formats for durations</h3>
          <p>
            Durations MUST be formatted and interpreted as defined in [[!xmlschema-2]], using the [[!ISO8601]] format <code>P<var>n</var>Y<var>n</var>M<var>n</var>DT<var>n</var>H<var>n</var>M<var>n</var>S</code>.
          <p>The <a href="http://www.w3.org/TR/tabular-data-model/#dfn-cell-value" class="externalDFN">cell value</a> is one or more durations extracted using the <code>format</code>.</p>
          </p>
        </section>
      </section>
    </section>
    <section>
      <h4>Merging Metadata</h4>
      <p>
        When processing a tabular data file, the <cite><a href="http://www.w3.org/TR/tabular-data-model/#locating-metadata">Locating Metadata</a></cite> in [[!tabular-data-model]] describes different locations for locating metadata. To property transform a tabular data file, such as a CSV, processors MUST merge metadata from these separate sources to create a single metadata document in a manner consistent with this algorithm.
      </p>
      <p>Implementations MUST merge metadata documents in a manner consistent with these rules. <a>Validators</a> MUST check and issue warnings where merge issues are found as noted below and in the relevant property definitions.</p>
      <p>
        Merging of metadata happens in order from highest priority to lowest priority by merging the first two metadata files (A and B) together to create new merged metadata AB'. This is then used to merge in the next metadata file until all metadata have been processed to create a <a>table group description</a>. If the top-level object of either of the metadata files are <a title="table description">table descriptions</a>, these are treated as if they were <a title="table group description">table group descriptions</a> containing a single table description (ie having a single <code>resource</code> property whose value is the same as the original table description). Ensure that <code>@context</code> definitions are moved from the <a>table description</a> to the <a>table group description</a>.
      </p>
      <p>
        The location of the merged metadata is defined to be the location of the highest priority metadata file. This makes the <a>base URL</a> either that of the defined <code>@base</code> or the location of the first metadata file when resolving URLs, unless the user provides a metadata file.
      </p>
      <p class="note">
        This typically will mean that the metadata location is that of the tabular data file from which embedded metadata is extracted, as that is otherwise the highest priority metadata file. As all metadata files typically have the same relative path, resolving a URL against any of these will result in the same absolute URL.
      </p>
      <p>Prior to merging, each description object is expanded relative to its <code>@context</code> and values are normalized as follows:</p>
      <ul>
        <li>If the property is a <a>link property</a> the value is turned into an absolute URL using the <a>base URL</a>.</li>
        <li>If the property is a <a>URI template property</a>, the value is turned into an absolute <a>URI template property</a> by expanding using the <a>base URL</a>.</li>
        <li>If the property is an <a>object property</a> accepting arrays, then an object value is turned into an array containing that object.</li>
        <li>If the property is a <a>natural language property</a> and the value is not already an object, it is turned into an object whose properties are language codes and where the values of those properties are arrays. The suitable language code for the values is determined through the <a>default language</a>; if it can't be determined the language code <code>und</code> MUST be used.</li>
        <li>If the property is a <a>common property</a> the values are expended using using <code>@context</code>.</li>
      </ul>
      <p>
        A description object B is <dfn>merged</dfn> into an original description object A by merging each property of B into A. If the property from B does not exist on A, it is simply added to A. If A does have the property, the way the values are merged depends on the type of the property, as follows:
      </p>
      <ul>
        <li>If the property is an <a>array property</a>, the way in which values are merged depends on the property; see the relevant property for this definition.</li>
        <li>If the property is a <a>link property</a>, <a>URI template property</a>, or <a>column reference property</a>, the value from A overrides that from B.</li>
        <li>If the property is an <a>object property</a>, then if the property only accepts single objects:
          <ol>
            <li>if the value of the property in A is a string or the value from B is a string then the value from A overrides that from B</li>
            <li>otherwise (if both values as objects) the objects are merged as described here</li>
          </ol>
          If the property accepts arrays, the result is an array of objects or strings: those from A followed by those from B that were not already a value in A.</li>
        <li>If the property is a <a>natural language property</a>, the result is an object whose properties are language codes and where the values of those properties are arrays. The arrays MUST provide the values from A followed by those from B that were not already a value in A. If a value exists in <code>und</code> and any other language</code> the value from <code>und</code> MUST be removed, ensuring that the <code>und</code> property is removed if it's value becomes an empty array.</li>
        <li>If the property is an <a>atomic property</a>, then if the property only accepts single values, the value from A overrides that from B; otherwise the result is an array of values: those from A followed by those from B that were not already a value in A.</li>
        <li>If the property is a <a>common property</a>, the result is an array containing values from A followed by values from B not already in A.</li>
      </ul>
      <p>
        If the type of the property cannot be determined, because it is not defined in this specification (ie because it is an extension property), the type of the property is determined based on its values in A and B, as follows, and merged accordingly:
      </p>
      <ul>
        <li>If the value of the property in A and the value of the property in B are both objects, they are treated as if the property is an <a>object property</a> that only accepts single objects.</li>
        <li>If one of the values is an array and the other is an object, they are treated as if the property is an <a>object property</a> that accepts arrays.</li>
        <li>If the value of the property in A and the value of the property in B are <a title="atomic value">atomic values</a>, they are treated as if the property is an <a>atomic property</a> that only accepts single values.</li>
        <li>If one of the values is an array and the other is an <a>atomic value</a>, they are treated as if the property is an <a>atomic property</a> that accepts arrays.</li>
      </ul>
      <p>For example, consider the following two Metadata documents to be merged:</p>
      <pre class="example highlight" title="Metadata A to be merged">
{
  "@context": ["http://www.w3.org/ns/csvw", {"@language": "en"}],
  "resources": [{
    "url": "http://example.com/doc1",
    "dc:title": "foo",
    "table-direction": "ltr",
    "tableSchema": {
      "aboutUrl": "{#foo}",
      "columns": [
        {"name": "foo", "title": "Foo", "required": true},
        {"name": "bar"}
      ]
    }
  }, {
    "url": "http://example.com/doc2"
  }]
}
      </pre>
      <pre class="example highlight" title="Metadata B to be merged">
{
  "@context": ["http://www.w3.org/ns/csvw", {"@base": "http://example.org/foo"}],
  "url": "http://example.com/doc1",
  "dc:description": "bar",
  "tableSchema": {
    "propertyUrl": "{#_name}",
    "columns": [
      {"title": "Foo", "required": false},
      {"name": "bar"},
      {}
    ]
  }
}
      </pre>
      <p>The process of merging performs the following steps:</p>
      <ol>
        <li>Transform <em>B</em> from <code>Table</code> metadata to <code>TableGroup</code> metadata:
      <pre class="example highlight" title="Metadata B as a TableGroup">
{
  "@context": ["http://www.w3.org/ns/csvw", {"@base": "http://example.org/foo"}],
  "resources": [{
    "url": "http://example.com/doc1",
    "dc:description": "bar",
    "tableSchema": {
      "propertyUrl": "{#_name}",
      "columns": [
        {"title": "Foo", "required": false},
        {"name": "bar"},
        {}
      ]
    }
  }]
}
      </pre>
        </li>
        <li>The <code>@context</code> is merged as defined in <a href="top-level-properties" class="sectionRef"></a> with <code>@base</code> imported into the value in <em>A</em>.</li>
        <li><code>resources</code> is an <a>array property</a> with rules specified in <a href="#table-groups" class="sectionRef"></a> and each value is merged accordingly:
          <ol>
            <li>The first value from <em>A</em> and <em>B</em> are now the following:
              <pre class="example highlight" title="first resources values A' and B'">
{
  "url": "http://example.com/doc1",
  "dc:title": "foo",
  "table-direction": "ltr",
  "tableSchema": {
    "aboutUrl": "{#foo}",
    "columns": [
      {"name": "foo", "title": "Foo", "required": true},
      {"name": "bar"}
    ]
  }
}

{
  "url": "http://example.com/doc1",
  "dc:description": "bar",
  "tableSchema": {
    "propertyUrl": "{#_name}",
    "columns": [
      {"title": "Foo", "required": false},
      {"name": "bar"},
      {}
    ]
  }
}
              </pre>
              The properties of these are expanded relative to the original metadata and context resulting in the following:
              <pre class="example highlight" title="first resources values A' and B'">
{
  "url": "http://example.com/doc1",
  "dc:title": {"@value": "foo", "@language": "en"},
  "table-direction": "ltr",
  "tableSchema": {
    "aboutUrl": "http://example.com/metadata-a{#foo}",
    "columns": [
      {"name": "foo", "title": {"en": ["Foo"]}, "required": true},
      {"name": "bar"}
    ]
  }
}

{
  "url": "http://example.com/doc1",
  "dc:description": {"@value": "bar"},
  "tableSchema": {
    "propertyUrl": "http://example.org/foo{#_name}",
    "columns": [
      {"title": {"en": ["Foo"]}, "required": false},
      {"name": "bar"},
      {}
    ]
  }
}
              </pre>
              Next each property from <em>B'</em> is considered:
              <ol>
                <li><code>url</code> is a <code>link property</code> so the value from <em>A'</em> overrides <em>B'</em> (althrough they are the same value)</li>
                <li><code>dc:description</code> does not exist in <em>A'</em> so it is added to <em>A'</em></li>
                <li>Each has <code>tableSchema</code> merged as an <a>object property</a> <em>A''</em> and <em>B''</em>:
                  <ol>
                    <li><em>B''</em> has a <code>propertyUrl</code> which is added to <em>A''</em>.</li>
                    <li>Each has <code>columns</code> which is merged as described in <a href="#schemas"></a>:
                      <ol>
                        <li>The first column matches on <code>title</code> because they each have the value <code>"Foo"</code> and the language tag <code>en</code> matches <code>und</code>. The value of <code>required</code> in <em>A''</em> is retained</li>
                        <li>The second column has a match on <code>name</code></li>
                      </ol>
                    </li>
                  </ol>
                </li>
              </ol>
              The merged table description is now the following:
              <pre class="example highlight" title="first resources values merged">
{
  "url": "http://example.com/doc1",
  "dc:title": {"@value": "foo", "@language": "en"},
  "dc:description": {"@value": "bar}",
  "table-direction": "ltr",
  "tableSchema": {
    "aboutUrl": "http://example.com/metadata-a{#foo}",
    "propertyUrl": "http://example.org/foo{#_name}",
    "columns": [
      {"name": "foo", "title": {"en": ["Foo"]}, "required": true},
      {"name": "bar"}
    ]
  }
}
              </pre>
            </li>
            <li>As <em>B</em> has no <code>resources</code> value, the value from <em>A</em> is retained.
          </ol>
        </li>
      </ol>
      <p>The resulting merged metadata is now the following:</p>
      <pre class="example highlight" title="Fully merged metadata">
{
  "@context": ["http://www.w3.org/ns/csvw", {
    "@language": "en",
    "@base": "http://example.org/foo"
  }],
  "resources": [{
    "url": "http://example.com/doc1",
    "dc:title": {"@value": "foo", "@language": "en"},
    "dc:description":{"@value": "bar"},
    "table-direction": "ltr",
    "tableSchema": {
      "aboutUrl": "http://example.com/metadata-a{#foo}",
      "propertyUrl": "http://example.org/foo{#_name}",
      "columns": [
        {"name": "foo", "title": {"en": ["Foo"]}, "required": true},
        {"name": "bar"}
      ]
    }
  }, {
    "url": "http://example.com/doc2"
  }]
}
      </pre>
    </section>
    <section>
      <h2>Processing Tables</h2>
      <p>
        This section describes how particular types of applications should use the metadata supplied about a CSV file when they process that CSV file.
      </p>
      <section>
        <h3>Displaying Tables</h3>
        <div class="issue">
          <p>
            We intend to include other sections here about:
          </p>
          <ul>
            <li>displaying metadata about groups of tables, tables, columns, rows, cells and regions</li>
            <li>what headings to use for columns when displaying tabular content</li>
            <li>how to format values in cells</li>
          </ul>
          <p>
            Much of this is likely to be non-normative. We invite comment on whether it's useful to provide this kind of guidance.
          </p>
        </div>
        <section>
          <h4>Bidirectional Tables</h4>
          <p>
            There are two levels of bidirectionality to consider when displaying tables: the directionality of the table (ie whether the columns should be arranged left-to-right or right-to-left) and the directionality of the content of individual cells.
          </p>
          <p>
            The <a href="#table-direction"><code>table-direction</code> property</a> provides information about the desired display of the table. If <code>table-direction=ltr</code> then the first column SHOULD be displayed on the left and the last column on the right. If <code>table-direction=rtl</code> then the first column SHOULD be displayed on the right and the last column on the left.
          </p>
          <p>
            If <code>table-direction=default</code> then tables SHOULD be displayed with attention to the bidirectionality of the content of the file. Specifically, the values of the cells in the table should be scanned breadth first: from the first cell in the first column through to the last cell in the first column, down to the last cell in the last column. If the first character in the table with a <a href="http://unicode.org/reports/tr9/#Bidirectional_Character_Types">strong type</a> as defined in [[!UNICODE-BIDI]] indicates a <abbr title="right-to-left">RTL</abbr> directionality, the table should be displayed with the first column on the right and the last column on the left. Otherwise, the table should be displayed with the first column on the left and the last column on the right. Characters such as whitespace, quotes, commas and numbers do not have a strong type, and therefore are skipped when identifying the character that determines the directionality of the table.
          </p>
          <p>
            Implementations SHOULD enable user preferences to override the indicated metadata about the directionality of the table.
          </p>
          <p>
            Once the directionality of the table has been determined, each cell within the table should be considered as a separate <a href="http://unicode.org/reports/tr9/#The_Paragraph_Level">paragraph</a>, as defined by the <abbr title="Unicode Bidirectional Algorithm">UBA</abbr> in [[!UNICODE-BIDI]]. The default directionality for the cell is determined by looking at the <a href="#cell-text-direction"><code>text-direction</code> property</a>, which is an <a>inherited property</a>.
          </p>
          <p>
            Thus, as defined by the <abbr title="Unicode Bidirectional Algorithm">UBA</abbr>, if a cell contains no characters with a strong type (if it's a number or date for example) then the way the cell is displayed should be determined by the <a href="#cell-text-direction"><code>text-direction</code> property</a> of the cell. However, when the cell contains characters with a strong type (such as letters) then they MUST be displayed according to the Unicode Bidirectional Algorithm as described in [[!UNICODE-BIDI]].
          </p>
        </section>
      </section>
      <section>
        <h3>Validating Tables</h3>
        <p class="issue">
          We intend to detail how to validate groups of tabular data files against metadata. This would be normative: compliant validators would have to report the errors and warnings that we define. We invite comment on whether this is a useful thing to specify.
        </p>
      </section>
      <section>
        <h3>Converting Tables</h3>
        <p>
          Conversions of tabular data to other formats operate over a <a href="http://www.w3.org/TR/tabular-data-model/#dfn-annotated-table">annotated table</a> constructed as defined in <a href="#annotating-tables" class="sectionRef"></a>. The mechanics of these conversions to other formats are defined in other specifications.
        </p>
        <p>
          Conversion specifications MUST define a default mapping from an annotated table that lacks any annotations (ie that is equivalent to an un-annotated table).
        </p>
        <p>
          Conversion specifications MUST use the <a>property value</a> of the <a href="#cell-propertyUrl"><code>propertyUrl</code></a> of a column as the basis for naming machine-readable fields in the target format, such as the name of the equivalent element or attribute in XML, property in JSON or property URI in RDF.
        </p>
        <p>
          Conversion specifications MAY use any of the properties defined in this specification to adjust the mapping of an annotated table into another format.
        </p>
        <p>
          Conversion specifications MAY define additional properties, not defined in this specification, which are specifically used when converting to the target format of the conversion. For example, a conversion to XML might specify a <code>element-or-attribute</code> property on columns that determines whether a particular column is represented through an element or an attribute in the data.
        </p>
        <p>
          Conversion specifications SHOULD specify format-specific properties specifying external processing steps to provide more control to people defining conversions. If these are specified, the conversion specification MUST specify at what point in the processing this external processing takes place, and what it takes place on. Examples might be:
        </p>
        <ul>
          <li>the URL of an XSLT file that is used to process XML after it is generated</li>
          <li>a string containing a SPARQL CONSTRUCT pattern that is executed on RDF after it is generated</li>
          <li>properties that contain definitions of Javascript callback functions that are used when processing particular columns or individual rows</li>
        </ul>
      </section>
    </section>
    <section>
      <h2>Security Considerations</h2>
      <p>
        Applications that process tabular data may use that data to drive other actions, which may have security implications. These behaviours are outside the scope of this specification.
      </p>
      <p>
        Third party metadata provided about a tabular data file (such as a CSV file) may rename or ignore headers, or exclude rows or columns, which may lead to data being misinterpreted by applications that process it.
      </p>
      <p>
        <a title="template specification">Template specifications</a> are a possible security risk as they enable the creators of metadata to reference arbitrary code that may be executed to convert tabular data into other formats. Implementations should run this arbitrary code in a sandboxed environment to reduce the security risk.
      </p>
    </section>
    <section class="appendix">
      <h2>Acknowledgements</h2>
      <p>
        This document is largely a copy of content from the <a href="http://dataprotocols.org/data-packages/">Data Package</a> specification and the <a href="http://dataprotocols.org/json-table-schema/">JSON Table Schema</a>, which are maintained as part of <a href="http://dataprotocols.org/">Data Protocols</a>. Particular contributors to that work are Rufus Pollock, Paul Fitzpatrick, Andrew Berkeley, Francis Irving, Benoit Chesneau, Leigh Dodds, Martin Keegan, and Gunnlaugur Thor Briem.
      </p>
    </section>
    <section class="appendix">
      <h2>IANA Considerations</h2>
      <section>
        <h3>Registration of <code>application/csvm+json</code></h3>
        <p class="issue">
          We intend to include a registration for a new datatype, namely <code>application/csvm+json</code>. We invite comment about how to indicate that this is consistent with <code>application/ld+json</code>, or whether we should just use <code>application/json</code> or <code>application/ld+json</code> and not create a specific media type for the metadata files defined in this document.
        </p>
      </section>
    </section>
    <section class="appendix">
      <h2>JSON-LD Context</h2>
      <p>
        The JSON-LD context, located at <code><a href="http://www.w3.org/ns/csvw.jsonld">http://www.w3.org/ns/csvw.jsonld</a></code> is used with metadata documents. When used within a metadata document,
        the context can be referenced as <code>http://www.w3.org/ns/csvw</code>.
        See [[csvw-context]] for a full description of defined terms and prefixes. This context may be updated from time-to-time to define new terms and prefixes.
      </p>
    </section>
  </body>
</html>

